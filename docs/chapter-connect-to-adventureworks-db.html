<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Connect to the adventureworks database in PostgreSQL | r-database-docker.utf8</title>
  <meta name="description" content="An introduction to Docker and PostgreSQL for R users to simulate use cases behind corporate walls." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Connect to the adventureworks database in PostgreSQL | r-database-docker.utf8" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to Docker and PostgreSQL for R users to simulate use cases behind corporate walls." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Connect to the adventureworks database in PostgreSQL | r-database-docker.utf8" />
  
  <meta name="twitter:description" content="An introduction to Docker and PostgreSQL for R users to simulate use cases behind corporate walls." />
  

<meta name="author" content="John David Smith, Sophie Yang, M. Edward (Ed) Borasky, Jim Tyhurst, Scott Came, Mary Anne Thygesen, and Ian Frantz" />


<meta name="date" content="2019-08-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-dbms-login-credentials.html">
<link rel="next" href="chapter-dbms-queries-intro.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.8/datatables.js"></script>
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R, Databases and Docker</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#using-r-to-query-a-dbms-in-your-organization"><i class="fa fa-check"></i><b>1.1</b> Using R to query a DBMS in your organization</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#docker-as-a-tool-for-users"><i class="fa fa-check"></i><b>1.2</b> Docker as a tool for UseRs</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#alternatives-to-docker"><i class="fa fa-check"></i><b>1.3</b> Alternatives to Docker</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#packages-used-in-this-book"><i class="fa fa-check"></i><b>1.4</b> Packages used in this book</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#who-are-we"><i class="fa fa-check"></i><b>1.5</b> Who are we?</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#how-did-this-project-come-about"><i class="fa fa-check"></i><b>1.6</b> How did this project come about?</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#navigation"><i class="fa fa-check"></i><b>1.7</b> Navigation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html"><i class="fa fa-check"></i><b>2</b> How to use this book</a><ul>
<li class="chapter" data-level="2.1" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#retrieve-the-code-from-github"><i class="fa fa-check"></i><b>2.1</b> Retrieve the code from GitHub</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#read-along-experiment-as-you-go"><i class="fa fa-check"></i><b>2.2</b> Read along, experiment as you go</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#participating"><i class="fa fa-check"></i><b>2.3</b> Participating</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#browsing-the-book"><i class="fa fa-check"></i><b>2.3.1</b> Browsing the book</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#diving-in"><i class="fa fa-check"></i><b>2.3.2</b> Diving in</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html"><i class="fa fa-check"></i><b>3</b> Learning Goals and Use Cases</a><ul>
<li class="chapter" data-level="3.1" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#challenge-goals-context-and-expectations"><i class="fa fa-check"></i><b>3.1</b> Challenge: goals, context and expectations</a></li>
<li class="chapter" data-level="3.2" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#the-challenge-investigating-a-question-using-an-organizations-database"><i class="fa fa-check"></i><b>3.2</b> The Challenge: Investigating a question using an organization’s database</a><ul>
<li class="chapter" data-level="3.2.1" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#problems-that-we-address-in-the-book"><i class="fa fa-check"></i><b>3.2.1</b> Problems that we address in the book</a></li>
<li class="chapter" data-level="3.2.2" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#book-structure"><i class="fa fa-check"></i><b>3.2.2</b> Book structure</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#making-your-way-through-the-book"><i class="fa fa-check"></i><b>3.3</b> Making your way through the book</a><ul>
<li class="chapter" data-level="3.3.1" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#r-packages"><i class="fa fa-check"></i><b>3.3.1</b> R Packages</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#adventure-works"><i class="fa fa-check"></i><b>3.4</b> Adventure Works</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html"><i class="fa fa-check"></i><b>4</b> Create and connect to the adventureworks database in PostgreSQL</a><ul>
<li class="chapter" data-level="4.1" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#verify-that-docker-is-up-running-and-clean-up-if-necessary"><i class="fa fa-check"></i><b>4.2</b> Verify that Docker is up, running, and clean up if necessary</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#clean-up-if-appropriate"><i class="fa fa-check"></i><b>4.3</b> Clean up if appropriate</a></li>
<li class="chapter" data-level="4.4" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#build-the-adventureworks-docker-image"><i class="fa fa-check"></i><b>4.4</b> Build the adventureworks Docker image</a></li>
<li class="chapter" data-level="4.5" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#run-the-adventureworks-docker-image"><i class="fa fa-check"></i><b>4.5</b> Run the adventureworks Docker Image</a></li>
<li class="chapter" data-level="4.6" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#connect-to-postgresql-with-r"><i class="fa fa-check"></i><b>4.6</b> Connect to PostgreSQL with R</a></li>
<li class="chapter" data-level="4.7" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#investigate-the-database-using-rstudio"><i class="fa fa-check"></i><b>4.7</b> Investigate the database using Rstudio</a></li>
<li class="chapter" data-level="4.8" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#stop-and-start-to-demonstrate-persistence"><i class="fa fa-check"></i><b>4.8</b> Stop and start to demonstrate persistence</a></li>
<li class="chapter" data-level="4.9" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#cleaning-up"><i class="fa fa-check"></i><b>4.9</b> Cleaning up</a></li>
<li class="chapter" data-level="4.10" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#using-the-adventureworks-container-in-the-rest-of-the-book"><i class="fa fa-check"></i><b>4.10</b> Using the <code>adventureworks</code> container in the rest of the book</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html"><i class="fa fa-check"></i><b>5</b> Securing and using your dbms log-in credentials</a><ul>
<li class="chapter" data-level="5.1" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#set-up-the-adventureworks-docker-container"><i class="fa fa-check"></i><b>5.1</b> Set up the adventureworks Docker container</a><ul>
<li class="chapter" data-level="5.1.1" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#verify-that-docker-is-running"><i class="fa fa-check"></i><b>5.1.1</b> Verify that Docker is running</a></li>
<li class="chapter" data-level="5.1.2" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#start-the-docker-container"><i class="fa fa-check"></i><b>5.1.2</b> Start the Docker container:</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#storing-your-dbms-credentials"><i class="fa fa-check"></i><b>5.2</b> Storing your dbms credentials</a><ul>
<li class="chapter" data-level="5.2.1" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#connect-with-postgres-using-the-sys.getenv-function"><i class="fa fa-check"></i><b>5.2.1</b> Connect with Postgres using the Sys.getenv function</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#clean-up"><i class="fa fa-check"></i><b>5.3</b> Clean up</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter-connect-to-adventureworks-db.html"><a href="chapter-connect-to-adventureworks-db.html"><i class="fa fa-check"></i><b>6</b> Connect to the adventureworks database in PostgreSQL</a><ul>
<li class="chapter" data-level="6.1" data-path="chapter-connect-to-adventureworks-db.html"><a href="chapter-connect-to-adventureworks-db.html#overview-1"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="chapter-connect-to-adventureworks-db.html"><a href="chapter-connect-to-adventureworks-db.html#verify-that-docker-is-up-running-and-clean-up-if-necessary-1"><i class="fa fa-check"></i><b>6.2</b> Verify that Docker is up, running, and clean up if necessary</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-connect-to-adventureworks-db.html"><a href="chapter-connect-to-adventureworks-db.html#connect-to-postgresql-with-r-1"><i class="fa fa-check"></i><b>6.3</b> Connect to PostgreSQL with R</a></li>
<li class="chapter" data-level="6.4" data-path="chapter-connect-to-adventureworks-db.html"><a href="chapter-connect-to-adventureworks-db.html#dplyr-connection-objects"><i class="fa fa-check"></i><b>6.4</b> <code>dplyr</code> connection objects</a></li>
<li class="chapter" data-level="6.5" data-path="chapter-connect-to-adventureworks-db.html"><a href="chapter-connect-to-adventureworks-db.html#stop-and-start-to-demonstrate-persistence-1"><i class="fa fa-check"></i><b>6.5</b> Stop and start to demonstrate persistence</a></li>
<li class="chapter" data-level="6.6" data-path="chapter-connect-to-adventureworks-db.html"><a href="chapter-connect-to-adventureworks-db.html#cleaning-up-1"><i class="fa fa-check"></i><b>6.6</b> Cleaning up</a></li>
<li class="chapter" data-level="6.7" data-path="chapter-connect-to-adventureworks-db.html"><a href="chapter-connect-to-adventureworks-db.html#using-the-adventureworks-container-in-the-rest-of-the-book-1"><i class="fa fa-check"></i><b>6.7</b> Using the <code>adventureworks</code> container in the rest of the book</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html"><i class="fa fa-check"></i><b>7</b> Introduction to DBMS queries</a><ul>
<li class="chapter" data-level="7.1" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#setup"><i class="fa fa-check"></i><b>7.1</b> Setup</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#downloading-a-single-table"><i class="fa fa-check"></i><b>7.2</b> Downloading a single table</a><ul>
<li class="chapter" data-level="7.2.1" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#downloading-the-entire-table"><i class="fa fa-check"></i><b>7.2.1</b> Downloading the entire table</a></li>
<li class="chapter" data-level="7.2.2" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#a-table-object-that-can-be-reused"><i class="fa fa-check"></i><b>7.2.2</b> A table <em>object</em> that can be reused</a></li>
<li class="chapter" data-level="7.2.3" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#controlling-the-number-of-rows-returned"><i class="fa fa-check"></i><b>7.2.3</b> Controlling the number of rows returned</a></li>
<li class="chapter" data-level="7.2.4" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#random-rows-from-the-dbms"><i class="fa fa-check"></i><b>7.2.4</b> Random rows from the dbms</a></li>
<li class="chapter" data-level="7.2.5" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#sub-setting-variables"><i class="fa fa-check"></i><b>7.2.5</b> Sub-setting variables</a></li>
<li class="chapter" data-level="7.2.6" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#translating-dplyr-code-to-sql-queries"><i class="fa fa-check"></i><b>7.2.6</b> Translating <code>dplyr</code> code to <code>SQL</code> queries</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#mixing-dplyr-and-sql"><i class="fa fa-check"></i><b>7.3</b> Mixing dplyr and SQL</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#examining-a-single-table-with-r"><i class="fa fa-check"></i><b>7.4</b> Examining a single table with R</a><ul>
<li class="chapter" data-level="7.4.1" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#str---a-base-package-workhorse"><i class="fa fa-check"></i><b>7.4.1</b> <code>str</code> - a base package workhorse</a></li>
<li class="chapter" data-level="7.4.2" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#always-look-at-your-data-with-head-view-or-kable"><i class="fa fa-check"></i><b>7.4.2</b> Always <strong>look</strong> at your data with <code>head</code>, <code>View</code>, or <code>kable</code></a></li>
<li class="chapter" data-level="7.4.3" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#the-summary-function-in-base"><i class="fa fa-check"></i><b>7.4.3</b> The <code>summary</code> function in <code>base</code></a></li>
<li class="chapter" data-level="7.4.4" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#the-glimpse-function-in-the-tibble-package"><i class="fa fa-check"></i><b>7.4.4</b> The <code>glimpse</code> function in the <code>tibble</code> package</a></li>
<li class="chapter" data-level="7.4.5" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#the-skim-function-in-the-skimr-package"><i class="fa fa-check"></i><b>7.4.5</b> The <code>skim</code> function in the <code>skimr</code> package</a></li>
<li class="chapter" data-level="7.4.6" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#close-the-connection-and-shut-down-adventureworks"><i class="fa fa-check"></i><b>7.4.6</b> Close the connection and shut down adventureworks</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#additional-reading"><i class="fa fa-check"></i><b>7.5</b> Additional reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html"><i class="fa fa-check"></i><b>8</b> Exploring a database</a><ul>
<li class="chapter" data-level="8.1" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html#setup-1"><i class="fa fa-check"></i><b>8.1</b> Setup</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html#getting-data-from-the-database"><i class="fa fa-check"></i><b>8.2</b> Getting data from the database</a><ul>
<li class="chapter" data-level="8.2.1" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html#finding-out-whats-there"><i class="fa fa-check"></i><b>8.2.1</b> Finding out what’s there</a></li>
<li class="chapter" data-level="8.2.2" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html#listing-all-the-fields-for-all-the-tables"><i class="fa fa-check"></i><b>8.2.2</b> Listing all the fields for all the tables</a></li>
<li class="chapter" data-level="8.2.3" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html#a-table-object-that-can-be-reused-1"><i class="fa fa-check"></i><b>8.2.3</b> A table object that can be reused</a></li>
<li class="chapter" data-level="8.2.4" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html#table-links-for-queries"><i class="fa fa-check"></i><b>8.2.4</b> Table links for queries</a></li>
<li class="chapter" data-level="8.2.5" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html#merge-this-into-the-above"><i class="fa fa-check"></i><b>8.2.5</b> merge this into the above:</a></li>
<li class="chapter" data-level="8.2.6" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html#close-the-connection-and-shut-down-adventureworks-1"><i class="fa fa-check"></i><b>8.2.6</b> Close the connection and shut down adventureworks</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="chapter-database-exploration.html"><a href="chapter-database-exploration.html#additional-reading-1"><i class="fa fa-check"></i><b>8.3</b> Additional reading</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html"><i class="fa fa-check"></i><b>9</b> Lazy Evaluation and Lazy Queries</a><ul>
<li class="chapter" data-level="9.1" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#setup-2"><i class="fa fa-check"></i><b>9.1</b> Setup</a></li>
<li class="chapter" data-level="9.2" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#r-is-lazy-and-comes-with-guardrails"><i class="fa fa-check"></i><b>9.2</b> R is lazy and comes with guardrails</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy-loading"><i class="fa fa-check"></i><b>9.2.1</b> Lazy loading</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy-evaluation"><i class="fa fa-check"></i><b>9.2.2</b> Lazy evaluation</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy-queries"><i class="fa fa-check"></i><b>9.2.3</b> Lazy Queries</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy-evaluation-and-lazy-queries"><i class="fa fa-check"></i><b>9.3</b> Lazy evaluation and lazy queries</a><ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#create-a-black-box-query-for-experimentation"><i class="fa fa-check"></i><b>9.3.1</b> Create a black box query for experimentation</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#experiment-overview"><i class="fa fa-check"></i><b>9.3.2</b> Experiment overview</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_print"><i class="fa fa-check"></i><b>9.3.3</b> Q %&gt;% print()</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_as-tibble"><i class="fa fa-check"></i><b>9.3.4</b> Q %&gt;% dplyr::as_tibble()</a></li>
<li class="chapter" data-level="9.3.5" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_head"><i class="fa fa-check"></i><b>9.3.5</b> Q %&gt;% head()</a></li>
<li class="chapter" data-level="9.3.6" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_tail"><i class="fa fa-check"></i><b>9.3.6</b> Q %&gt;% tail()</a></li>
<li class="chapter" data-level="9.3.7" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_length"><i class="fa fa-check"></i><b>9.3.7</b> Q %&gt;% length()</a></li>
<li class="chapter" data-level="9.3.8" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_str"><i class="fa fa-check"></i><b>9.3.8</b> Q %&gt;% str()</a></li>
<li class="chapter" data-level="9.3.9" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_nrow"><i class="fa fa-check"></i><b>9.3.9</b> Q %&gt;% nrow()</a></li>
<li class="chapter" data-level="9.3.10" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_tally"><i class="fa fa-check"></i><b>9.3.10</b> Q %&gt;% dplyr::tally()</a></li>
<li class="chapter" data-level="9.3.11" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_collect"><i class="fa fa-check"></i><b>9.3.11</b> Q %&gt;% dplyr::collect()</a></li>
<li class="chapter" data-level="9.3.12" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_plot-categories"><i class="fa fa-check"></i><b>9.3.12</b> Q %&gt;% ggplot</a></li>
<li class="chapter" data-level="9.3.13" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_show-query"><i class="fa fa-check"></i><b>9.3.13</b> Q %&gt;% dplyr::show_query()</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#other-resources"><i class="fa fa-check"></i><b>9.4</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html"><i class="fa fa-check"></i><b>10</b> Lazy Evaluation and Execution Environment</a><ul>
<li class="chapter" data-level="10.1" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#setup-3"><i class="fa fa-check"></i><b>10.1</b> Setup</a><ul>
<li class="chapter" data-level="10.1.1" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#experiment-overview-1"><i class="fa fa-check"></i><b>10.1.1</b> Experiment overview</a></li>
<li class="chapter" data-level="10.1.2" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#time-based-execution-environment-issues"><i class="fa fa-check"></i><b>10.1.2</b> Time-based, execution environment issues</a></li>
<li class="chapter" data-level="10.1.3" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#lazy_q_build"><i class="fa fa-check"></i><b>10.1.3</b> Q %&gt;% <code>more dplyr</code></a></li>
<li class="chapter" data-level="10.1.4" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#many-handy-r-functions-cant-be-translated-to-sql"><i class="fa fa-check"></i><b>10.1.4</b> Many handy R functions can’t be translated to SQL</a></li>
<li class="chapter" data-level="10.1.5" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#further-lazy-execution-examples"><i class="fa fa-check"></i><b>10.1.5</b> Further lazy execution examples</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#other-resources-1"><i class="fa fa-check"></i><b>10.2</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html"><i class="fa fa-check"></i><b>11</b> Getting metadata about and from PostgreSQL</a><ul>
<li class="chapter" data-level="11.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#database-contents-and-structure"><i class="fa fa-check"></i><b>11.1</b> Database contents and structure</a><ul>
<li class="chapter" data-level="11.1.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#database-structure"><i class="fa fa-check"></i><b>11.1.1</b> Database structure</a></li>
<li class="chapter" data-level="11.1.2" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#contents-of-the-information_schema"><i class="fa fa-check"></i><b>11.1.2</b> Contents of the <code>information_schema</code></a></li>
<li class="chapter" data-level="11.1.3" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#what-tables-are-in-the-database"><i class="fa fa-check"></i><b>11.1.3</b> What tables are in the database?</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#what-columns-do-those-tables-contain"><i class="fa fa-check"></i><b>11.2</b> What columns do those tables contain?</a><ul>
<li class="chapter" data-level="11.2.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#what-is-the-difference-between-a-view-and-a-base-table"><i class="fa fa-check"></i><b>11.2.1</b> What is the difference between a <code>VIEW</code> and a <code>BASE TABLE</code>?</a></li>
<li class="chapter" data-level="11.2.2" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#what-data-types-are-found-in-the-database"><i class="fa fa-check"></i><b>11.2.2</b> What data types are found in the database?</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#characterizing-how-things-are-named"><i class="fa fa-check"></i><b>11.3</b> Characterizing how things are named</a><ul>
<li class="chapter" data-level="11.3.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#counting-columns-and-name-reuse"><i class="fa fa-check"></i><b>11.3.1</b> Counting columns and name reuse</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#database-keys"><i class="fa fa-check"></i><b>11.4</b> Database keys</a><ul>
<li class="chapter" data-level="11.4.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#direct-sql"><i class="fa fa-check"></i><b>11.4.1</b> Direct SQL</a></li>
<li class="chapter" data-level="11.4.2" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#database-keys-with-dplyr"><i class="fa fa-check"></i><b>11.4.2</b> Database keys with dplyr</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#creating-your-own-data-dictionary"><i class="fa fa-check"></i><b>11.5</b> Creating your own data dictionary</a></li>
<li class="chapter" data-level="11.6" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#save-your-work"><i class="fa fa-check"></i><b>11.6</b> Save your work!</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html"><i class="fa fa-check"></i><b>A</b> Background and Basic Concepts</a><ul>
<li class="chapter" data-level="A.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#the-big-picture-r-and-the-docker-postgresql-playground-on-your-machine"><i class="fa fa-check"></i><b>A.1</b> The big picture: R and the Docker / PostgreSQL playground on your machine</a></li>
<li class="chapter" data-level="A.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#your-computer-and-its-operating-system"><i class="fa fa-check"></i><b>A.2</b> Your computer and its operating system</a></li>
<li class="chapter" data-level="A.3" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#r"><i class="fa fa-check"></i><b>A.3</b> R</a></li>
<li class="chapter" data-level="A.4" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#our-sqlpetr-package"><i class="fa fa-check"></i><b>A.4</b> Our <code>sqlpetr</code> package</a></li>
<li class="chapter" data-level="A.5" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#docker"><i class="fa fa-check"></i><b>A.5</b> Docker</a><ul>
<li class="chapter" data-level="A.5.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#virtual-machines-and-hypervisors"><i class="fa fa-check"></i><b>A.5.1</b> Virtual machines and hypervisors</a></li>
<li class="chapter" data-level="A.5.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#containers"><i class="fa fa-check"></i><b>A.5.2</b> Containers</a></li>
<li class="chapter" data-level="A.5.3" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#docker-itself"><i class="fa fa-check"></i><b>A.5.3</b> Docker itself</a></li>
<li class="chapter" data-level="A.5.4" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#docker-objects"><i class="fa fa-check"></i><b>A.5.4</b> Docker objects</a></li>
<li class="chapter" data-level="A.5.5" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#hosting-docker-on-windows-machines"><i class="fa fa-check"></i><b>A.5.5</b> Hosting Docker on Windows machines</a></li>
<li class="chapter" data-level="A.5.6" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#hosting-docker-on-macos-machines"><i class="fa fa-check"></i><b>A.5.6</b> Hosting Docker on macOS machines</a></li>
<li class="chapter" data-level="A.5.7" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#hosting-docker-on-unix-machines"><i class="fa fa-check"></i><b>A.5.7</b> Hosting Docker on UNIX machines</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#normal-and-normalized-data"><i class="fa fa-check"></i><b>A.6</b> ‘Normal’ and ‘normalized’ data</a><ul>
<li class="chapter" data-level="A.6.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#tidy-data"><i class="fa fa-check"></i><b>A.6.1</b> Tidy data</a></li>
<li class="chapter" data-level="A.6.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#design-of-normal-data"><i class="fa fa-check"></i><b>A.6.2</b> Design of “normal data”</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#sql-language"><i class="fa fa-check"></i><b>A.7</b> SQL Language</a><ul>
<li class="chapter" data-level="A.7.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#data-manipulation-langauge-dml"><i class="fa fa-check"></i><b>A.7.1</b> Data Manipulation Langauge (DML)</a></li>
<li class="chapter" data-level="A.7.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#data-definition-langauge-ddl"><i class="fa fa-check"></i><b>A.7.2</b> Data Definition Langauge (DDL)</a></li>
<li class="chapter" data-level="A.7.3" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#data-control-language-dcl"><i class="fa fa-check"></i><b>A.7.3</b> Data Control Language (DCL)</a></li>
<li class="chapter" data-level="A.7.4" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#transaction-control-language-tcl"><i class="fa fa-check"></i><b>A.7.4</b> Transaction Control Language (TCL)</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#enterprise-dbms"><i class="fa fa-check"></i><b>A.8</b> Enterprise DBMS</a><ul>
<li class="chapter" data-level="A.8.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#sql-databases"><i class="fa fa-check"></i><b>A.8.1</b> SQL databases</a></li>
<li class="chapter" data-level="A.8.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#data-mapping-between-r-vs-sql-data-types"><i class="fa fa-check"></i><b>A.8.2</b> Data mapping between R vs SQL data types</a></li>
<li class="chapter" data-level="A.8.3" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#postgresql-and-connection-parameters"><i class="fa fa-check"></i><b>A.8.3</b> PostgreSQL and connection parameters</a></li>
<li class="chapter" data-level="A.8.4" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#connecting-the-r-and-dbms-environments"><i class="fa fa-check"></i><b>A.8.4</b> Connecting the R and DBMS environments</a></li>
<li class="chapter" data-level="A.8.5" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#using-sqlite-to-simulate-an-enterprise-dbms"><i class="fa fa-check"></i><b>A.8.5</b> Using SQLite to simulate an enterprise DBMS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="chapter-appendix-setup-instructions.html"><a href="chapter-appendix-setup-instructions.html"><i class="fa fa-check"></i><b>B</b> - Setup instructions</a><ul>
<li class="chapter" data-level="B.1" data-path="chapter-appendix-setup-instructions.html"><a href="chapter-appendix-setup-instructions.html#sandbox-prerequisites"><i class="fa fa-check"></i><b>B.1</b> Sandbox prerequisites</a></li>
<li class="chapter" data-level="B.2" data-path="chapter-appendix-setup-instructions.html"><a href="chapter-appendix-setup-instructions.html#r-rstudio-and-git"><i class="fa fa-check"></i><b>B.2</b> R, RStudio and Git</a></li>
<li class="chapter" data-level="B.3" data-path="chapter-appendix-setup-instructions.html"><a href="chapter-appendix-setup-instructions.html#install-docker"><i class="fa fa-check"></i><b>B.3</b> Install Docker</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html"><i class="fa fa-check"></i><b>C</b> Appendix B - Additional technical details for Windows users</a><ul>
<li class="chapter" data-level="C.1" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#hardware-requirements"><i class="fa fa-check"></i><b>C.1</b> Hardware requirements</a></li>
<li class="chapter" data-level="C.2" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#software-requirements"><i class="fa fa-check"></i><b>C.2</b> Software requirements</a><ul>
<li class="chapter" data-level="C.2.1" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#windows-7-8-8.1-and-windows-10-home-64-bit"><i class="fa fa-check"></i><b>C.2.1</b> Windows 7, 8, 8.1 and Windows 10 Home (64 bit)</a></li>
<li class="chapter" data-level="C.2.2" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#windows-10-pro"><i class="fa fa-check"></i><b>C.2.2</b> Windows 10 Pro</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#docker-for-windows-settings"><i class="fa fa-check"></i><b>C.3</b> Docker for Windows settings</a><ul>
<li class="chapter" data-level="C.3.1" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#shared-drives"><i class="fa fa-check"></i><b>C.3.1</b> Shared drives</a></li>
<li class="chapter" data-level="C.3.2" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#kubernetes"><i class="fa fa-check"></i><b>C.3.2</b> Kubernetes</a></li>
</ul></li>
<li class="chapter" data-level="C.4" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#git-github-and-line-endings"><i class="fa fa-check"></i><b>C.4</b> Git, GitHub and line endings</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html"><i class="fa fa-check"></i><b>D</b> Appendix C - PostgreSQL Authentication</a><ul>
<li class="chapter" data-level="D.1" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#introduction"><i class="fa fa-check"></i><b>D.1</b> Introduction</a></li>
<li class="chapter" data-level="D.2" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#password-authentication-on-the-postgresql-docker-image"><i class="fa fa-check"></i><b>D.2</b> Password authentication on the PostgreSQL Docker image</a></li>
<li class="chapter" data-level="D.3" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#adding-roles"><i class="fa fa-check"></i><b>D.3</b> Adding roles</a><ul>
<li class="chapter" data-level="D.3.1" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#setting-up-docker"><i class="fa fa-check"></i><b>D.3.1</b> Setting up Docker</a></li>
<li class="chapter" data-level="D.3.2" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#creating-a-new-container"><i class="fa fa-check"></i><b>D.3.2</b> Creating a new container</a></li>
<li class="chapter" data-level="D.3.3" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#adding-a-role"><i class="fa fa-check"></i><b>D.3.3</b> Adding a role</a></li>
<li class="chapter" data-level="D.3.4" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#did-it-work"><i class="fa fa-check"></i><b>D.3.4</b> Did it work?</a></li>
<li class="chapter" data-level="D.3.5" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#remove-the-container"><i class="fa fa-check"></i><b>D.3.5</b> Remove the container</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="E" data-path="chapter-appendix-dplyr-functions.html"><a href="chapter-appendix-dplyr-functions.html"><i class="fa fa-check"></i><b>E</b> Dplyr functions and SQL cross-walk</a></li>
<li class="chapter" data-level="F" data-path="chapter-appendix-dbi-index.html"><a href="chapter-appendix-dbi-index.html"><i class="fa fa-check"></i><b>F</b> DBI package functions - INDEX</a></li>
<li class="chapter" data-level="G" data-path="chapter-appendix-dplyr-to-postres-translation.html"><a href="chapter-appendix-dplyr-to-postres-translation.html"><i class="fa fa-check"></i><b>G</b> Appendix _ Dplyr to SQL translations</a><ul>
<li class="chapter" data-level="G.1" data-path="chapter-appendix-dplyr-to-postres-translation.html"><a href="chapter-appendix-dplyr-to-postres-translation.html#overview-2"><i class="fa fa-check"></i><b>G.1</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html"><i class="fa fa-check"></i><b>H</b> Appendix Additional resources</a><ul>
<li class="chapter" data-level="H.1" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#editing-this-book"><i class="fa fa-check"></i><b>H.1</b> Editing this book</a></li>
<li class="chapter" data-level="H.2" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#docker-alternatives"><i class="fa fa-check"></i><b>H.2</b> Docker alternatives</a></li>
<li class="chapter" data-level="H.3" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#docker-and-r"><i class="fa fa-check"></i><b>H.3</b> Docker and R</a></li>
<li class="chapter" data-level="H.4" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#documentation-for-docker-and-postgresql"><i class="fa fa-check"></i><b>H.4</b> Documentation for Docker and PostgreSQL</a></li>
<li class="chapter" data-level="H.5" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#sql-and-dplyr"><i class="fa fa-check"></i><b>H.5</b> SQL and dplyr</a></li>
<li class="chapter" data-level="H.6" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#more-resources"><i class="fa fa-check"></i><b>H.6</b> More Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><div class="line-block">Exploring Enterprise Databases with R<br />
A Tidyverse Approach&quot;</div></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter_connect-to-adventureworks-db" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Connect to the adventureworks database in PostgreSQL</h1>
<blockquote>
<p>This chapter demonstrates how to:</p>
<ul>
<li>Create and connect to the PostgreSQL <code>adventureworks</code> database in Docker</li>
<li>Keep necessary credentials secret while being available to R when it executes.</li>
<li>Connect to and disconnect R from the <code>adventureworks</code> database</li>
<li>Set up the environment for subsequent chapters</li>
</ul>
</blockquote>
<div id="overview-1" class="section level2">
<h2><span class="header-section-number">6.1</span> Overview</h2>
<p>Docker commands can be run from a terminal (e.g., the Rstudio Terminal pane) or with a <code>system2()</code> command. The necessary functions to start, stop Docker containers and do other busy work are provided in the <code>sqlpetr</code> package.</p>
<blockquote>
<p>Note: The functions in the package are designed to help you focus on interacting with a dbms from R. You can ignore how they work until you are ready to delve into the details. They are all named to begin with <code>sp_</code>. The first time a function is called in the book, we provide a note explaining its use.</p>
</blockquote>
<p>Please install the <code>sqlpetr</code> package if not already installed:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">library</span>(devtools)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="cf">if</span> (<span class="op">!</span><span class="kw">require</span>(sqlpetr)) {</a>
<a class="sourceLine" id="cb35-3" data-line-number="3">    remotes<span class="op">::</span><span class="kw">install_github</span>(</a>
<a class="sourceLine" id="cb35-4" data-line-number="4">      <span class="st">&quot;smithjd/sqlpetr&quot;</span>,</a>
<a class="sourceLine" id="cb35-5" data-line-number="5">      <span class="dt">force =</span> <span class="ot">TRUE</span>, <span class="dt">build =</span> <span class="ot">FALSE</span>, <span class="dt">quiet =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-6" data-line-number="6">}</a></code></pre></div>
<p>Note that when you install this package the first time, it will ask you to update the packages it uses and that may take some time.</p>
<p>These packages are called in this Chapter:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2"><span class="kw">library</span>(DBI)</a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="kw">library</span>(RPostgres)</a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="kw">require</span>(knitr)</a>
<a class="sourceLine" id="cb36-6" data-line-number="6"><span class="kw">library</span>(dbplyr)</a>
<a class="sourceLine" id="cb36-7" data-line-number="7"><span class="kw">library</span>(sqlpetr)</a>
<a class="sourceLine" id="cb36-8" data-line-number="8"><span class="kw">library</span>(bookdown)</a>
<a class="sourceLine" id="cb36-9" data-line-number="9"><span class="kw">library</span>(here)</a></code></pre></div>
</div>
<div id="verify-that-docker-is-up-running-and-clean-up-if-necessary-1" class="section level2">
<h2><span class="header-section-number">6.2</span> Verify that Docker is up, running, and clean up if necessary</h2>
<blockquote>
<p>The <code>sp_check_that_docker_is_up</code> function from the <code>sqlpetr</code> package checks whether Docker is up and running. If it’s not, then you need to install, launch or re-install Docker.</p>
</blockquote>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">sp_check_that_docker_is_up</span>()</a></code></pre></div>
<pre><code>## [1] &quot;Docker is up but running no containers&quot;</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw">sp_docker_start</span>(<span class="st">&quot;adventureworks&quot;</span>)</a></code></pre></div>
</div>
<div id="connect-to-postgresql-with-r-1" class="section level2">
<h2><span class="header-section-number">6.3</span> Connect to PostgreSQL with R</h2>
<p>*CHECK for <code>sqlpetr</code> update!<code>The</code>sp_make_simple_pg<code>function we called above created a container from the</code>postgres:11<code>library image downloaded from Docker Hub. As part of the process, it set the password for the PostgreSQL database superuser</code>postgres` to the value
“postgres”.</p>
<p>For simplicity, we are using a weak password at this point and it’s shown here
and in the code in plain text. That is bad practice because user credentials
should not be shared in open code like that. A <a href="#dbms-login">subsequent chapter</a>
demonstrates how to store and use credentials to access the DBMS so that they
are kept private.</p>
<blockquote>
<p>The <code>sp_get_postgres_connection</code> function from the <code>sqlpetr</code> package gets a DBI connection string to a PostgreSQL database, waiting if it is not ready. This function connects to an instance of PostgreSQL and we assign it to a symbol, <code>con</code>, for subsequent use. The <code>connctions_tab = TRUE</code> parameter opens a connections tab that’s useful for navigating a database.</p>
</blockquote>
<blockquote>
<p>Note that we are using port <em>5439</em> for PostgreSQL inside the container and published to <code>localhost</code>. Why? If you have PostgreSQL already running on the host or another container, it probably claimed port 5432, since that’s the default. So we need to use a different port for <em>our</em> PostgreSQL container.</p>
</blockquote>
<p>Use the DBI package to connect to the <code>adventureworks</code> database in PostgreSQL. Remember the settings discussion about [keeping passwords hidden][Pause for some security considerations]</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">con &lt;-<span class="st"> </span><span class="kw">sp_get_postgres_connection</span>(</a>
<a class="sourceLine" id="cb40-2" data-line-number="2">  <span class="dt">host =</span> <span class="st">&quot;localhost&quot;</span>,</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">  <span class="dt">port =</span> <span class="dv">5432</span>,  <span class="co"># this version still using 5432!!!</span></a>
<a class="sourceLine" id="cb40-4" data-line-number="4">  <span class="dt">user =</span> <span class="st">&quot;postgres&quot;</span>,</a>
<a class="sourceLine" id="cb40-5" data-line-number="5">  <span class="dt">password =</span> <span class="st">&quot;postgres&quot;</span>,</a>
<a class="sourceLine" id="cb40-6" data-line-number="6">  <span class="dt">dbname =</span> <span class="st">&quot;adventureworks&quot;</span>,</a>
<a class="sourceLine" id="cb40-7" data-line-number="7">  <span class="dt">seconds_to_test =</span> <span class="dv">20</span>, <span class="dt">connection_tab =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8">)</a></code></pre></div>
<p>That’s equivalent to excuting this code to download the table from the DBMS to a local data frame:</p>
<p>For the moment we by-pass some complexity that results from the fact that the <code>adventureworks</code> database has multiple <em>schemas</em> and that we are interested in only one of them, named <code>information_schema</code>.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;information_schema&quot;</span>, <span class="st">&quot;schemata&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(catalog_name, schema_name, schema_owner) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">  </span><span class="kw">collect</span>()</a></code></pre></div>
<pre><code>## # A tibble: 16 x 3
##    catalog_name   schema_name        schema_owner
##    &lt;chr&gt;          &lt;chr&gt;              &lt;chr&gt;       
##  1 adventureworks sales              postgres    
##  2 adventureworks sa                 postgres    
##  3 adventureworks purchasing         postgres    
##  4 adventureworks pu                 postgres    
##  5 adventureworks production         postgres    
##  6 adventureworks pr                 postgres    
##  7 adventureworks person             postgres    
##  8 adventureworks pe                 postgres    
##  9 adventureworks humanresources     postgres    
## 10 adventureworks hr                 postgres    
## 11 adventureworks information_schema postgres    
## 12 adventureworks public             postgres    
## 13 adventureworks pg_catalog         postgres    
## 14 adventureworks pg_toast_temp_1    postgres    
## 15 adventureworks pg_temp_1          postgres    
## 16 adventureworks pg_toast           postgres</code></pre>
<p>Schemas will be discussed later on because multiple schemas are the norm in an enterprise database environment, but they are a side issue at this point. So we switch the order in which PostgreSQL searches for objects with the following SQL code:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">dbExecute</span>(con, <span class="st">&quot;set search_path to sales, public;&quot;</span>)</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>With the custom <code>search_path</code>, the following command shows the tables in the <code>sales</code> schema. In the <code>adventureworks</code> database, there are no tables in the <code>public</code> schema.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">dbListTables</span>(con)</a></code></pre></div>
<pre><code>##  [1] &quot;countryregioncurrency&quot;             
##  [2] &quot;customer&quot;                          
##  [3] &quot;currencyrate&quot;                      
##  [4] &quot;creditcard&quot;                        
##  [5] &quot;personcreditcard&quot;                  
##  [6] &quot;specialoffer&quot;                      
##  [7] &quot;specialofferproduct&quot;               
##  [8] &quot;salesorderheadersalesreason&quot;       
##  [9] &quot;shoppingcartitem&quot;                  
## [10] &quot;salespersonquotahistory&quot;           
## [11] &quot;salesperson&quot;                       
## [12] &quot;currency&quot;                          
## [13] &quot;store&quot;                             
## [14] &quot;salesorderheader&quot;                  
## [15] &quot;salesorderdetail&quot;                  
## [16] &quot;salesreason&quot;                       
## [17] &quot;salesterritoryhistory&quot;             
## [18] &quot;vindividualcustomer&quot;               
## [19] &quot;vpersondemographics&quot;               
## [20] &quot;vsalesperson&quot;                      
## [21] &quot;vsalespersonsalesbyfiscalyears&quot;    
## [22] &quot;vsalespersonsalesbyfiscalyearsdata&quot;
## [23] &quot;vstorewithaddresses&quot;               
## [24] &quot;vstorewithcontacts&quot;                
## [25] &quot;vstorewithdemographics&quot;            
## [26] &quot;salestaxrate&quot;                      
## [27] &quot;salesterritory&quot;</code></pre>
<p>Notice there are several tables that start with the letter <em>v</em>: they are actually <em>views</em> which will turn out to be important. They are clearly distinguished in the connections tab, but the naming is a matter of convention.</p>
<p>Same for <code>dbListFields</code>:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw">dbListFields</span>(con, <span class="st">&quot;salesorderheader&quot;</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;salesorderid&quot;           &quot;revisionnumber&quot;        
##  [3] &quot;orderdate&quot;              &quot;duedate&quot;               
##  [5] &quot;shipdate&quot;               &quot;status&quot;                
##  [7] &quot;onlineorderflag&quot;        &quot;purchaseordernumber&quot;   
##  [9] &quot;accountnumber&quot;          &quot;customerid&quot;            
## [11] &quot;salespersonid&quot;          &quot;territoryid&quot;           
## [13] &quot;billtoaddressid&quot;        &quot;shiptoaddressid&quot;       
## [15] &quot;shipmethodid&quot;           &quot;creditcardid&quot;          
## [17] &quot;creditcardapprovalcode&quot; &quot;currencyrateid&quot;        
## [19] &quot;subtotal&quot;               &quot;taxamt&quot;                
## [21] &quot;freight&quot;                &quot;totaldue&quot;              
## [23] &quot;comment&quot;                &quot;rowguid&quot;               
## [25] &quot;modifieddate&quot;</code></pre>
<p>Thus with this search order, the following two produce identical results:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;sales&quot;</span>, <span class="st">&quot;salesorderheader&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-2" data-line-number="2"><span class="st">  </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 25]
## # Database: postgres [postgres@localhost:5432/adventureworks]
##   salesorderid revisionnumber orderdate           duedate            
##          &lt;int&gt;          &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;             
## 1        43659              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 2        43660              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 3        43661              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 4        43662              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 5        43663              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 6        43664              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## # … with 21 more variables: shipdate &lt;dttm&gt;, status &lt;int&gt;,
## #   onlineorderflag &lt;lgl&gt;, purchaseordernumber &lt;chr&gt;, accountnumber &lt;chr&gt;,
## #   customerid &lt;int&gt;, salespersonid &lt;int&gt;, territoryid &lt;int&gt;,
## #   billtoaddressid &lt;int&gt;, shiptoaddressid &lt;int&gt;, shipmethodid &lt;int&gt;,
## #   creditcardid &lt;int&gt;, creditcardapprovalcode &lt;chr&gt;,
## #   currencyrateid &lt;int&gt;, subtotal &lt;dbl&gt;, taxamt &lt;dbl&gt;, freight &lt;dbl&gt;,
## #   totaldue &lt;dbl&gt;, comment &lt;chr&gt;, rowguid &lt;chr&gt;, modifieddate &lt;dttm&gt;</code></pre>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">tbl</span>(con, <span class="st">&quot;salesorderheader&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-2" data-line-number="2"><span class="st">  </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 25]
## # Database: postgres [postgres@localhost:5432/adventureworks]
##   salesorderid revisionnumber orderdate           duedate            
##          &lt;int&gt;          &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;             
## 1        43659              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 2        43660              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 3        43661              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 4        43662              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 5        43663              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 6        43664              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## # … with 21 more variables: shipdate &lt;dttm&gt;, status &lt;int&gt;,
## #   onlineorderflag &lt;lgl&gt;, purchaseordernumber &lt;chr&gt;, accountnumber &lt;chr&gt;,
## #   customerid &lt;int&gt;, salespersonid &lt;int&gt;, territoryid &lt;int&gt;,
## #   billtoaddressid &lt;int&gt;, shiptoaddressid &lt;int&gt;, shipmethodid &lt;int&gt;,
## #   creditcardid &lt;int&gt;, creditcardapprovalcode &lt;chr&gt;,
## #   currencyrateid &lt;int&gt;, subtotal &lt;dbl&gt;, taxamt &lt;dbl&gt;, freight &lt;dbl&gt;,
## #   totaldue &lt;dbl&gt;, comment &lt;chr&gt;, rowguid &lt;chr&gt;, modifieddate &lt;dttm&gt;</code></pre>
</div>
<div id="dplyr-connection-objects" class="section level2">
<h2><span class="header-section-number">6.4</span> <code>dplyr</code> connection objects</h2>
<p>As introduced in the previous chapter, the <code>dplyr::tbl</code> function creates an object that might <strong>look</strong> like a data frame in that when you enter it on the command line, it prints a bunch of rows from the dbms table. But it is actually a <strong>list</strong> object that <code>dplyr</code> uses for constructing queries and retrieving data from the DBMS.</p>
<p>The following code illustrates these issues. The <code>dplyr::tbl</code> function creates the connection object that we store in an object named <code>salesorderheader_table</code>:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1">salesorderheader_table &lt;-<span class="st"> </span>dplyr<span class="op">::</span><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;sales&quot;</span>, <span class="st">&quot;salesorderheader&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>rowguid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb53-3" data-line-number="3"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">salesorderheader_details_updated =</span> modifieddate)</a></code></pre></div>
<p>At first glance, it <em>acts</em> like a data frame when you print it, although it only prints 10 of the table’s 31,465 rows:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">salesorderheader_table</a></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 24]
## # Database: postgres [postgres@localhost:5432/adventureworks]
##    salesorderid revisionnumber orderdate           duedate            
##           &lt;int&gt;          &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;             
##  1        43659              8 2011-05-31 00:00:00 2011-06-12 00:00:00
##  2        43660              8 2011-05-31 00:00:00 2011-06-12 00:00:00
##  3        43661              8 2011-05-31 00:00:00 2011-06-12 00:00:00
##  4        43662              8 2011-05-31 00:00:00 2011-06-12 00:00:00
##  5        43663              8 2011-05-31 00:00:00 2011-06-12 00:00:00
##  6        43664              8 2011-05-31 00:00:00 2011-06-12 00:00:00
##  7        43665              8 2011-05-31 00:00:00 2011-06-12 00:00:00
##  8        43666              8 2011-05-31 00:00:00 2011-06-12 00:00:00
##  9        43667              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 10        43668              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## # … with more rows, and 20 more variables: shipdate &lt;dttm&gt;, status &lt;int&gt;,
## #   onlineorderflag &lt;lgl&gt;, purchaseordernumber &lt;chr&gt;, accountnumber &lt;chr&gt;,
## #   customerid &lt;int&gt;, salespersonid &lt;int&gt;, territoryid &lt;int&gt;,
## #   billtoaddressid &lt;int&gt;, shiptoaddressid &lt;int&gt;, shipmethodid &lt;int&gt;,
## #   creditcardid &lt;int&gt;, creditcardapprovalcode &lt;chr&gt;,
## #   currencyrateid &lt;int&gt;, subtotal &lt;dbl&gt;, taxamt &lt;dbl&gt;, freight &lt;dbl&gt;,
## #   totaldue &lt;dbl&gt;, comment &lt;chr&gt;, salesorderheader_details_updated &lt;dttm&gt;</code></pre>
<p>However, notice that the first output line shows <code>??</code>, rather than providing the number of rows in the table. Similarly, the next to last line shows:</p>
<pre><code>    … with more rows, and 20 more variables:</code></pre>
<p>whereas the output for a normal <code>tbl</code> of this salesorderheader data would say:</p>
<pre><code>    … with 31,455 more rows, and 20 more variables:</code></pre>
<p>So even though <code>salesorderheader_table</code> is a <code>tbl</code>, it’s <strong>also</strong> a <code>tbl_PqConnection</code>:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw">class</span>(salesorderheader_table)</a></code></pre></div>
<pre><code>## [1] &quot;tbl_PqConnection&quot; &quot;tbl_dbi&quot;          &quot;tbl_sql&quot;         
## [4] &quot;tbl_lazy&quot;         &quot;tbl&quot;</code></pre>
<p>It is not just a normal <code>tbl</code> of data. We can see that from the structure of <code>salesorderheader_table</code>:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw">str</span>(salesorderheader_table)</a></code></pre></div>
<pre><code>## List of 2
##  $ src:List of 2
##   ..$ con  :Formal class &#39;PqConnection&#39; [package &quot;RPostgres&quot;] with 3 slots
##   .. .. ..@ ptr     :&lt;externalptr&gt; 
##   .. .. ..@ bigint  : chr &quot;integer64&quot;
##   .. .. ..@ typnames:&#39;data.frame&#39;:   796 obs. of  2 variables:
##   .. .. .. ..$ oid    : int [1:796] 16 17 18 19 20 21 22 23 24 25 ...
##   .. .. .. ..$ typname: chr [1:796] &quot;bool&quot; &quot;bytea&quot; &quot;char&quot; &quot;name&quot; ...
##   ..$ disco: NULL
##   ..- attr(*, &quot;class&quot;)= chr [1:4] &quot;src_PqConnection&quot; &quot;src_dbi&quot; &quot;src_sql&quot; &quot;src&quot;
##  $ ops:List of 4
##   ..$ name: chr &quot;select&quot;
##   ..$ x   :List of 2
##   .. ..$ x   : &#39;ident_q&#39; chr &quot;sales.salesorderheader&quot;
##   .. ..$ vars: chr [1:25] &quot;salesorderid&quot; &quot;revisionnumber&quot; &quot;orderdate&quot; &quot;duedate&quot; ...
##   .. ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;op_base_remote&quot; &quot;op_base&quot; &quot;op&quot;
##   ..$ dots: list()
##   ..$ args:List of 1
##   .. ..$ vars:List of 24
##   .. .. ..$ salesorderid                    : symbol salesorderid
##   .. .. ..$ revisionnumber                  : symbol revisionnumber
##   .. .. ..$ orderdate                       : symbol orderdate
##   .. .. ..$ duedate                         : symbol duedate
##   .. .. ..$ shipdate                        : symbol shipdate
##   .. .. ..$ status                          : symbol status
##   .. .. ..$ onlineorderflag                 : symbol onlineorderflag
##   .. .. ..$ purchaseordernumber             : symbol purchaseordernumber
##   .. .. ..$ accountnumber                   : symbol accountnumber
##   .. .. ..$ customerid                      : symbol customerid
##   .. .. ..$ salespersonid                   : symbol salespersonid
##   .. .. ..$ territoryid                     : symbol territoryid
##   .. .. ..$ billtoaddressid                 : symbol billtoaddressid
##   .. .. ..$ shiptoaddressid                 : symbol shiptoaddressid
##   .. .. ..$ shipmethodid                    : symbol shipmethodid
##   .. .. ..$ creditcardid                    : symbol creditcardid
##   .. .. ..$ creditcardapprovalcode          : symbol creditcardapprovalcode
##   .. .. ..$ currencyrateid                  : symbol currencyrateid
##   .. .. ..$ subtotal                        : symbol subtotal
##   .. .. ..$ taxamt                          : symbol taxamt
##   .. .. ..$ freight                         : symbol freight
##   .. .. ..$ totaldue                        : symbol totaldue
##   .. .. ..$ comment                         : symbol comment
##   .. .. ..$ salesorderheader_details_updated: symbol modifieddate
##   ..- attr(*, &quot;class&quot;)= chr [1:3] &quot;op_select&quot; &quot;op_single&quot; &quot;op&quot;
##  - attr(*, &quot;class&quot;)= chr [1:5] &quot;tbl_PqConnection&quot; &quot;tbl_dbi&quot; &quot;tbl_sql&quot; &quot;tbl_lazy&quot; ...</code></pre>
<p>It has only <em>two</em> rows! The first row contains all the information in the <code>con</code> object, which contains information about all the tables and objects in the database:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">salesorderheader_table<span class="op">$</span>src<span class="op">$</span>con<span class="op">@</span>typnames<span class="op">$</span>typname[<span class="dv">380</span><span class="op">:</span><span class="dv">437</span>]</a></code></pre></div>
<pre><code>##  [1] &quot;user_mappings&quot;                   &quot;tablefunc_crosstab_2&quot;           
##  [3] &quot;_tablefunc_crosstab_2&quot;           &quot;tablefunc_crosstab_3&quot;           
##  [5] &quot;_tablefunc_crosstab_3&quot;           &quot;tablefunc_crosstab_4&quot;           
##  [7] &quot;_tablefunc_crosstab_4&quot;           &quot;AccountNumber&quot;                  
##  [9] &quot;_AccountNumber&quot;                  &quot;Flag&quot;                           
## [11] &quot;_Flag&quot;                           &quot;Name&quot;                           
## [13] &quot;_Name&quot;                           &quot;NameStyle&quot;                      
## [15] &quot;_NameStyle&quot;                      &quot;OrderNumber&quot;                    
## [17] &quot;_OrderNumber&quot;                    &quot;Phone&quot;                          
## [19] &quot;_Phone&quot;                          &quot;department&quot;                     
## [21] &quot;_department&quot;                     &quot;pg_toast_16439&quot;                 
## [23] &quot;d&quot;                               &quot;_d&quot;                             
## [25] &quot;employee&quot;                        &quot;_employee&quot;                      
## [27] &quot;pg_toast_16450&quot;                  &quot;e&quot;                              
## [29] &quot;_e&quot;                              &quot;employeedepartmenthistory&quot;      
## [31] &quot;_employeedepartmenthistory&quot;      &quot;edh&quot;                            
## [33] &quot;_edh&quot;                            &quot;employeepayhistory&quot;             
## [35] &quot;_employeepayhistory&quot;             &quot;pg_toast_16482&quot;                 
## [37] &quot;eph&quot;                             &quot;_eph&quot;                           
## [39] &quot;jobcandidate&quot;                    &quot;_jobcandidate&quot;                  
## [41] &quot;pg_toast_16495&quot;                  &quot;jc&quot;                             
## [43] &quot;_jc&quot;                             &quot;shift&quot;                          
## [45] &quot;_shift&quot;                          &quot;pg_toast_16506&quot;                 
## [47] &quot;s&quot;                               &quot;_s&quot;                             
## [49] &quot;department_departmentid_seq&quot;     &quot;jobcandidate_jobcandidateid_seq&quot;
## [51] &quot;shift_shiftid_seq&quot;               &quot;address&quot;                        
## [53] &quot;_address&quot;                        &quot;businessentityaddress&quot;          
## [55] &quot;_businessentityaddress&quot;          &quot;countryregion&quot;                  
## [57] &quot;_countryregion&quot;                  &quot;pg_toast_16533&quot;</code></pre>
<p>The second row contains a list of the columns in the <code>salesorderheader</code> table, among other things:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">salesorderheader_table<span class="op">$</span>ops<span class="op">$</span>x<span class="op">$</span>vars</a></code></pre></div>
<pre><code>##  [1] &quot;salesorderid&quot;           &quot;revisionnumber&quot;        
##  [3] &quot;orderdate&quot;              &quot;duedate&quot;               
##  [5] &quot;shipdate&quot;               &quot;status&quot;                
##  [7] &quot;onlineorderflag&quot;        &quot;purchaseordernumber&quot;   
##  [9] &quot;accountnumber&quot;          &quot;customerid&quot;            
## [11] &quot;salespersonid&quot;          &quot;territoryid&quot;           
## [13] &quot;billtoaddressid&quot;        &quot;shiptoaddressid&quot;       
## [15] &quot;shipmethodid&quot;           &quot;creditcardid&quot;          
## [17] &quot;creditcardapprovalcode&quot; &quot;currencyrateid&quot;        
## [19] &quot;subtotal&quot;               &quot;taxamt&quot;                
## [21] &quot;freight&quot;                &quot;totaldue&quot;              
## [23] &quot;comment&quot;                &quot;rowguid&quot;               
## [25] &quot;modifieddate&quot;</code></pre>
<p><code>salesorderheader_table</code> holds information needed to get the data from the ‘salesorderheader’ table, but <code>salesorderheader_table</code> does not hold the data itself. In the following sections, we will examine more closely this relationship between the <code>salesorderheader_table</code> object and the data in the database’s ‘salesorderheader’ table.</p>
<p>Disconnect from the database:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="kw">dbDisconnect</span>(con)</a></code></pre></div>
</div>
<div id="stop-and-start-to-demonstrate-persistence-1" class="section level2">
<h2><span class="header-section-number">6.5</span> Stop and start to demonstrate persistence</h2>
<p>Stop the container:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw">sp_docker_stop</span>(<span class="st">&quot;adventureworks&quot;</span>)</a>
<a class="sourceLine" id="cb67-2" data-line-number="2"><span class="kw">sp_docker_containers_tibble</span>()</a></code></pre></div>
<pre><code>## # A tibble: 0 x 0</code></pre>
<p>When we stopped <code>adventureworks</code>, it no longer appeared in the tibble. But the
container is still there. <code>sp_docker_containers_tibble</code> by default only lists
the <em>running</em> containers. But we can use the <code>list_all</code> option and see it:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw">sp_docker_containers_tibble</span>(<span class="dt">list_all =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 12
##   container_id image command created_at created ports status size  names
##   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;
## 1 0105899fe547 post… docker… 2019-08-2… 26 sec… &lt;NA&gt;  Exite… 0B (… adve…
## # … with 3 more variables: labels &lt;chr&gt;, mounts &lt;chr&gt;, networks &lt;chr&gt;</code></pre>
<p>Restart the container and verify that the adventureworks tables are still there:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" data-line-number="1"><span class="kw">sp_docker_start</span>(<span class="st">&quot;adventureworks&quot;</span>)</a>
<a class="sourceLine" id="cb71-2" data-line-number="2"><span class="kw">sp_docker_containers_tibble</span>()</a></code></pre></div>
<pre><code>## # A tibble: 1 x 12
##   container_id image command created_at created ports status size  names
##   &lt;chr&gt;        &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;
## 1 0105899fe547 post… docker… 2019-08-2… 28 sec… 0.0.… Up Le… 63B … adve…
## # … with 3 more variables: labels &lt;chr&gt;, mounts &lt;chr&gt;, networks &lt;chr&gt;</code></pre>
<p>Connect to the <code>adventureworks</code> database in PostgreSQL:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">con &lt;-<span class="st"> </span><span class="kw">sp_get_postgres_connection</span>(</a>
<a class="sourceLine" id="cb73-2" data-line-number="2">  <span class="dt">host =</span> <span class="st">&quot;localhost&quot;</span>,</a>
<a class="sourceLine" id="cb73-3" data-line-number="3">  <span class="dt">port =</span> <span class="dv">5432</span>,</a>
<a class="sourceLine" id="cb73-4" data-line-number="4">  <span class="dt">user =</span> <span class="st">&quot;postgres&quot;</span>,</a>
<a class="sourceLine" id="cb73-5" data-line-number="5">  <span class="dt">password =</span> <span class="st">&quot;postgres&quot;</span>,</a>
<a class="sourceLine" id="cb73-6" data-line-number="6">  <span class="dt">dbname =</span> <span class="st">&quot;adventureworks&quot;</span>,</a>
<a class="sourceLine" id="cb73-7" data-line-number="7">  <span class="dt">seconds_to_test =</span> <span class="dv">30</span></a>
<a class="sourceLine" id="cb73-8" data-line-number="8">)</a></code></pre></div>
<p>Check that you can still see the first few rows of the <code>salesorderheader</code> table:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" data-line-number="1"><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;sales&quot;</span>, <span class="st">&quot;salesorderheader&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb74-2" data-line-number="2"><span class="st">  </span><span class="kw">head</span>()</a></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 25]
## # Database: postgres [postgres@localhost:5432/adventureworks]
##   salesorderid revisionnumber orderdate           duedate            
##          &lt;int&gt;          &lt;int&gt; &lt;dttm&gt;              &lt;dttm&gt;             
## 1        43659              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 2        43660              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 3        43661              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 4        43662              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 5        43663              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## 6        43664              8 2011-05-31 00:00:00 2011-06-12 00:00:00
## # … with 21 more variables: shipdate &lt;dttm&gt;, status &lt;int&gt;,
## #   onlineorderflag &lt;lgl&gt;, purchaseordernumber &lt;chr&gt;, accountnumber &lt;chr&gt;,
## #   customerid &lt;int&gt;, salespersonid &lt;int&gt;, territoryid &lt;int&gt;,
## #   billtoaddressid &lt;int&gt;, shiptoaddressid &lt;int&gt;, shipmethodid &lt;int&gt;,
## #   creditcardid &lt;int&gt;, creditcardapprovalcode &lt;chr&gt;,
## #   currencyrateid &lt;int&gt;, subtotal &lt;dbl&gt;, taxamt &lt;dbl&gt;, freight &lt;dbl&gt;,
## #   totaldue &lt;dbl&gt;, comment &lt;chr&gt;, rowguid &lt;chr&gt;, modifieddate &lt;dttm&gt;</code></pre>
</div>
<div id="cleaning-up-1" class="section level2">
<h2><span class="header-section-number">6.6</span> Cleaning up</h2>
<p>Always have R disconnect from the database when you’re done.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" data-line-number="1"><span class="kw">dbDisconnect</span>(con)</a></code></pre></div>
<p>Stop the <code>adventureworks</code> container:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1"><span class="kw">sp_docker_stop</span>(<span class="st">&quot;adventureworks&quot;</span>)</a></code></pre></div>
<p>Show that the container still exists even though it’s not running</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1"><span class="kw">sp_show_all_docker_containers</span>()</a></code></pre></div>
<pre><code>## CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                              PORTS               NAMES
## 0105899fe547        postgres:11         &quot;docker-entrypoint.s…&quot;   28 seconds ago      Exited (0) Less than a second ago                       adventureworks</code></pre>
<p>Next time, you can just use this command to start the container:</p>
<blockquote>
<p><code>sp_docker_start(&quot;adventureworks&quot;)</code></p>
</blockquote>
<p>And once stopped, the container can be removed with:</p>
<blockquote>
<p><code>sp_check_that_docker_is_up(&quot;adventureworks&quot;)</code></p>
</blockquote>
</div>
<div id="using-the-adventureworks-container-in-the-rest-of-the-book-1" class="section level2">
<h2><span class="header-section-number">6.7</span> Using the <code>adventureworks</code> container in the rest of the book</h2>
<p>After this point in the book, we assume that Docker is up and that we can always start up our <em>adventureworks database</em> with:</p>
<blockquote>
<p><code>sp_docker_start(&quot;adventureworks&quot;)</code></p>
</blockquote>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-dbms-login-credentials.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-dbms-queries-intro.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smithjd/sql-pet/edit/master/065-connect-to-postgres-with-adventureworks.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
