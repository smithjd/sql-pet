<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 12 Leveraging Database Views | Exploring Enterprise Databases with R: A Tidyverse Approach</title>
  <meta name="description" content="An introduction to Docker and PostgreSQL for R users to simulate use cases behind corporate walls." />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 12 Leveraging Database Views | Exploring Enterprise Databases with R: A Tidyverse Approach" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="An introduction to Docker and PostgreSQL for R users to simulate use cases behind corporate walls." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 12 Leveraging Database Views | Exploring Enterprise Databases with R: A Tidyverse Approach" />
  
  <meta name="twitter:description" content="An introduction to Docker and PostgreSQL for R users to simulate use cases behind corporate walls." />
  

<meta name="author" content="John David Smith, Sophie Yang, M. Edward (Ed) Borasky, Jim Tyhurst, Scott Came, Mary Anne Thygesen, and Ian Frantz" />


<meta name="date" content="2019-11-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapter-lazy-evaluation-and-timing.html">
<link rel="next" href="chapter-postgresql-metadata.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.10/datatables.js"></script>
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.19/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.19/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R, Databases and Docker</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#using-r-to-query-a-dbms-in-your-organization"><i class="fa fa-check"></i><b>1.1</b> Using R to query a DBMS in your organization</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#docker-as-a-tool-for-users"><i class="fa fa-check"></i><b>1.2</b> Docker as a tool for UseRs</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#alternatives-to-docker"><i class="fa fa-check"></i><b>1.3</b> Alternatives to Docker</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#packages-used-in-this-book"><i class="fa fa-check"></i><b>1.4</b> Packages used in this book</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#who-are-we"><i class="fa fa-check"></i><b>1.5</b> Who are we?</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#how-did-this-project-come-about"><i class="fa fa-check"></i><b>1.6</b> How did this project come about?</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#navigation"><i class="fa fa-check"></i><b>1.7</b> Navigation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html"><i class="fa fa-check"></i><b>2</b> How to use this book</a><ul>
<li class="chapter" data-level="2.1" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#retrieve-the-code-from-github"><i class="fa fa-check"></i><b>2.1</b> Retrieve the code from GitHub</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#read-along-experiment-as-you-go"><i class="fa fa-check"></i><b>2.2</b> Read along, experiment as you go</a></li>
<li class="chapter" data-level="2.3" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#participating"><i class="fa fa-check"></i><b>2.3</b> Participating</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#browsing-the-book"><i class="fa fa-check"></i><b>2.3.1</b> Browsing the book</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapter-how-to-use-this-book.html"><a href="chapter-how-to-use-this-book.html#diving-in"><i class="fa fa-check"></i><b>2.3.2</b> Diving in</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html"><i class="fa fa-check"></i><b>3</b> Chapter Learning Goals and Use Cases</a><ul>
<li class="chapter" data-level="3.1" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#the-books-challenge-goals-context-and-expectations"><i class="fa fa-check"></i><b>3.1</b> The Book’s Challenge: goals, context and expectations</a><ul>
<li class="chapter" data-level="3.1.1" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#the-challenge-investigating-a-question-using-an-organizations-database"><i class="fa fa-check"></i><b>3.1.1</b> The Challenge: Investigating a question using an organization’s database</a></li>
<li class="chapter" data-level="3.1.2" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#strategies"><i class="fa fa-check"></i><b>3.1.2</b> Strategies</a></li>
<li class="chapter" data-level="3.1.3" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#problems-that-we-address-in-the-book"><i class="fa fa-check"></i><b>3.1.3</b> Problems that we address in the book</a></li>
<li class="chapter" data-level="3.1.4" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#signposts"><i class="fa fa-check"></i><b>3.1.4</b> Signposts</a></li>
<li class="chapter" data-level="3.1.5" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#book-structure"><i class="fa fa-check"></i><b>3.1.5</b> Book structure</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#making-your-way-through-the-book"><i class="fa fa-check"></i><b>3.2</b> Making your way through the book</a><ul>
<li class="chapter" data-level="3.2.1" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#r-packages"><i class="fa fa-check"></i><b>3.2.1</b> R Packages</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="chapter-learning-goals.html"><a href="chapter-learning-goals.html#adventure-works"><i class="fa fa-check"></i><b>3.3</b> Adventure Works</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html"><i class="fa fa-check"></i><b>4</b> Create and connect to the adventureworks database in PostgreSQL</a><ul>
<li class="chapter" data-level="4.1" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#overview"><i class="fa fa-check"></i><b>4.1</b> Overview</a></li>
<li class="chapter" data-level="4.2" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#verify-that-docker-is-up-running-and-clean-up-if-necessary"><i class="fa fa-check"></i><b>4.2</b> Verify that Docker is up, running, and clean up if necessary</a></li>
<li class="chapter" data-level="4.3" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#clean-up-if-appropriate"><i class="fa fa-check"></i><b>4.3</b> Clean up if appropriate</a></li>
<li class="chapter" data-level="4.4" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#build-the-adventureworks-docker-image"><i class="fa fa-check"></i><b>4.4</b> Build the adventureworks Docker image</a></li>
<li class="chapter" data-level="4.5" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#run-the-adventureworks-docker-image"><i class="fa fa-check"></i><b>4.5</b> Run the adventureworks Docker Image</a></li>
<li class="chapter" data-level="4.6" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#connect-to-postgresql"><i class="fa fa-check"></i><b>4.6</b> Connect to PostgreSQL</a></li>
<li class="chapter" data-level="4.7" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#adventureworks-schemas"><i class="fa fa-check"></i><b>4.7</b> Adventureworks Schemas</a></li>
<li class="chapter" data-level="4.8" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#investigate-the-database-using-rstudio"><i class="fa fa-check"></i><b>4.8</b> Investigate the database using Rstudio</a></li>
<li class="chapter" data-level="4.9" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#cleaning-up-diconnect-from-the-database-and-stop-docker"><i class="fa fa-check"></i><b>4.9</b> Cleaning up: diconnect from the database and stop Docker</a></li>
<li class="chapter" data-level="4.10" data-path="chapter-setup-adventureworks-db.html"><a href="chapter-setup-adventureworks-db.html#using-the-adventureworks-container-in-the-rest-of-the-book"><i class="fa fa-check"></i><b>4.10</b> Using the <code>adventureworks</code> container in the rest of the book</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html"><i class="fa fa-check"></i><b>5</b> Securing and using your dbms log-in credentials</a><ul>
<li class="chapter" data-level="5.1" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#set-up-the-adventureworks-docker-container"><i class="fa fa-check"></i><b>5.1</b> Set up the adventureworks Docker container</a><ul>
<li class="chapter" data-level="5.1.1" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#verify-that-docker-is-running"><i class="fa fa-check"></i><b>5.1.1</b> Verify that Docker is running</a></li>
<li class="chapter" data-level="5.1.2" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#start-the-docker-container"><i class="fa fa-check"></i><b>5.1.2</b> Start the Docker container:</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#storing-your-dbms-credentials"><i class="fa fa-check"></i><b>5.2</b> Storing your dbms credentials</a><ul>
<li class="chapter" data-level="5.2.1" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#connect-with-postgres-using-the-sys.getenv-function"><i class="fa fa-check"></i><b>5.2.1</b> Connect with Postgres using the Sys.getenv function</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="chapter-dbms-login-credentials.html"><a href="chapter-dbms-login-credentials.html#disconnect-from-the-database-and-stop-docker"><i class="fa fa-check"></i><b>5.3</b> Disconnect from the database and stop Docker</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapter-connect-to-db-with-r-code.html"><a href="chapter-connect-to-db-with-r-code.html"><i class="fa fa-check"></i><b>6</b> Connecting to the database with R code</a><ul>
<li class="chapter" data-level="6.1" data-path="chapter-connect-to-db-with-r-code.html"><a href="chapter-connect-to-db-with-r-code.html#verify-that-docker-is-up-and-running-and-start-the-database"><i class="fa fa-check"></i><b>6.1</b> Verify that Docker is up and running, and start the database</a></li>
<li class="chapter" data-level="6.2" data-path="chapter-connect-to-db-with-r-code.html"><a href="chapter-connect-to-db-with-r-code.html#connect-to-postgresql-1"><i class="fa fa-check"></i><b>6.2</b> Connect to PostgreSQL</a></li>
<li class="chapter" data-level="6.3" data-path="chapter-connect-to-db-with-r-code.html"><a href="chapter-connect-to-db-with-r-code.html#set-schema-search-path-and-list-its-contents"><i class="fa fa-check"></i><b>6.3</b> Set schema search path and list its contents</a></li>
<li class="chapter" data-level="6.4" data-path="chapter-connect-to-db-with-r-code.html"><a href="chapter-connect-to-db-with-r-code.html#anatomy-of-a-dplyr-connection-object"><i class="fa fa-check"></i><b>6.4</b> Anatomy of a <code>dplyr</code> connection object</a></li>
<li class="chapter" data-level="6.5" data-path="chapter-connect-to-db-with-r-code.html"><a href="chapter-connect-to-db-with-r-code.html#disconnect-from-the-database-and-stop-docker-1"><i class="fa fa-check"></i><b>6.5</b> Disconnect from the database and stop Docker</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html"><i class="fa fa-check"></i><b>7</b> Introduction to DBMS queries</a><ul>
<li class="chapter" data-level="7.1" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#setup"><i class="fa fa-check"></i><b>7.1</b> Setup</a></li>
<li class="chapter" data-level="7.2" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#methods-for-downloading-a-single-table"><i class="fa fa-check"></i><b>7.2</b> Methods for downloading a single table</a><ul>
<li class="chapter" data-level="7.2.1" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#read-the-entire-table"><i class="fa fa-check"></i><b>7.2.1</b> Read the entire table</a></li>
<li class="chapter" data-level="7.2.2" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#create-a-pointer-to-a-table-that-can-be-reused"><i class="fa fa-check"></i><b>7.2.2</b> Create a pointer to a table that can be reused</a></li>
<li class="chapter" data-level="7.2.3" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#controlling-the-number-of-rows-returned-with-collect"><i class="fa fa-check"></i><b>7.2.3</b> Controlling the number of rows returned with <code>collect()</code></a></li>
<li class="chapter" data-level="7.2.4" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#retrieving-random-rows-from-the-dbms"><i class="fa fa-check"></i><b>7.2.4</b> Retrieving random rows from the DBMS</a></li>
<li class="chapter" data-level="7.2.5" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#sub-setting-variables"><i class="fa fa-check"></i><b>7.2.5</b> Sub-setting variables</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#translating-dplyr-code-to-sql-queries"><i class="fa fa-check"></i><b>7.3</b> Translating <code>dplyr</code> code to <code>SQL</code> queries</a></li>
<li class="chapter" data-level="7.4" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#mixing-dplyr-and-sql"><i class="fa fa-check"></i><b>7.4</b> Mixing dplyr and SQL</a></li>
<li class="chapter" data-level="7.5" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#examining-a-single-table-with-r"><i class="fa fa-check"></i><b>7.5</b> Examining a single table with R</a><ul>
<li class="chapter" data-level="7.5.1" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#str---a-base-package-workhorse"><i class="fa fa-check"></i><b>7.5.1</b> <code>str</code> - a base package workhorse</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#always-look-at-your-data-with-head-view-or-kable"><i class="fa fa-check"></i><b>7.5.2</b> Always <strong>look</strong> at your data with <code>head</code>, <code>View</code>, or <code>kable</code></a></li>
<li class="chapter" data-level="7.5.3" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#the-summary-function-in-base"><i class="fa fa-check"></i><b>7.5.3</b> The <code>summary</code> function in <code>base</code></a></li>
<li class="chapter" data-level="7.5.4" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#the-glimpse-function-in-the-tibble-package"><i class="fa fa-check"></i><b>7.5.4</b> The <code>glimpse</code> function in the <code>tibble</code> package</a></li>
<li class="chapter" data-level="7.5.5" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#the-skim-function-in-the-skimr-package"><i class="fa fa-check"></i><b>7.5.5</b> The <code>skim</code> function in the <code>skimr</code> package</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#disconnect-from-the-database-and-stop-docker-2"><i class="fa fa-check"></i><b>7.6</b> Disconnect from the database and stop Docker</a></li>
<li class="chapter" data-level="7.7" data-path="chapter-dbms-queries-intro.html"><a href="chapter-dbms-queries-intro.html#additional-reading"><i class="fa fa-check"></i><b>7.7</b> Additional reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html"><i class="fa fa-check"></i><b>8</b> Asking Business Questions From a Single Table</a><ul>
<li class="chapter" data-level="8.1" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#setup-our-standard-working-environment"><i class="fa fa-check"></i><b>8.1</b> Setup our standard working environment</a></li>
<li class="chapter" data-level="8.2" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#a-word-on-naming"><i class="fa fa-check"></i><b>8.2</b> A word on naming</a></li>
<li class="chapter" data-level="8.3" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#the-overall-adventureworks-sales-picture"><i class="fa fa-check"></i><b>8.3</b> The overall AdventureWorks sales picture</a></li>
<li class="chapter" data-level="8.4" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#annual-sales"><i class="fa fa-check"></i><b>8.4</b> Annual sales</a><ul>
<li class="chapter" data-level="8.4.1" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#total-sales-by-year"><i class="fa fa-check"></i><b>8.4.1</b> Total sales by year</a></li>
<li class="chapter" data-level="8.4.2" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#total-order-volume"><i class="fa fa-check"></i><b>8.4.2</b> Total order volume</a></li>
<li class="chapter" data-level="8.4.3" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#average-dollars-per-sale"><i class="fa fa-check"></i><b>8.4.3</b> Average dollars per sale</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#monthly-sales"><i class="fa fa-check"></i><b>8.5</b> Monthly Sales</a><ul>
<li class="chapter" data-level="8.5.1" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#check-lagged-monthly-data"><i class="fa fa-check"></i><b>8.5.1</b> Check lagged monthly data</a></li>
<li class="chapter" data-level="8.5.2" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#comparing-dollars-and-orders-to-a-base-year"><i class="fa fa-check"></i><b>8.5.2</b> Comparing dollars and orders to a base year</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#the-effect-of-online-sales"><i class="fa fa-check"></i><b>8.6</b> The effect of online sales</a><ul>
<li class="chapter" data-level="8.6.1" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#add-onlineorderflag-to-our-annual-sales-query"><i class="fa fa-check"></i><b>8.6.1</b> Add <code>onlineorderflag</code> to our annual sales query</a></li>
<li class="chapter" data-level="8.6.2" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#annual-sales-comparison"><i class="fa fa-check"></i><b>8.6.2</b> Annual Sales comparison</a></li>
<li class="chapter" data-level="8.6.3" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#order-volume-comparison"><i class="fa fa-check"></i><b>8.6.3</b> Order volume comparison</a></li>
<li class="chapter" data-level="8.6.4" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#comparing-sales-rep-sales-to-online-orders"><i class="fa fa-check"></i><b>8.6.4</b> Comparing <strong>Sales Rep</strong> sales to <strong>Online</strong> Orders</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#impact-of-order-type-on-monthly-sales"><i class="fa fa-check"></i><b>8.7</b> Impact of order type on monthly sales</a><ul>
<li class="chapter" data-level="8.7.1" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#retrieve-monthly-sales-with-the-onlineorderflag"><i class="fa fa-check"></i><b>8.7.1</b> Retrieve monthly sales with the <code>onlineorderflag</code></a></li>
<li class="chapter" data-level="8.7.2" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#monthly-variation-compared-to-a-trend-line"><i class="fa fa-check"></i><b>8.7.2</b> Monthly variation compared to a trend line</a></li>
<li class="chapter" data-level="8.7.3" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#compare-monthly-lagged-data-by-order-type"><i class="fa fa-check"></i><b>8.7.3</b> Compare monthly lagged data by order type</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#detect-and-diagnose-the-day-of-the-month-problem"><i class="fa fa-check"></i><b>8.8</b> Detect and diagnose the day of the month problem</a><ul>
<li class="chapter" data-level="8.8.1" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#sales-rep-orderdate-distribution"><i class="fa fa-check"></i><b>8.8.1</b> Sales Rep Orderdate Distribution</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#correcting-the-order-date-for-sales-reps"><i class="fa fa-check"></i><b>8.9</b> Correcting the order date for <strong>Sales Reps</strong></a><ul>
<li class="chapter" data-level="8.9.1" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#define-a-date-correction-function-in-r"><i class="fa fa-check"></i><b>8.9.1</b> Define a date correction function in R</a></li>
<li class="chapter" data-level="8.9.2" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#define-and-store-a-postgresql-function-to-correct-the-date"><i class="fa fa-check"></i><b>8.9.2</b> Define and store a PostgreSQL function to correct the date</a></li>
<li class="chapter" data-level="8.9.3" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#use-the-postgresql-function"><i class="fa fa-check"></i><b>8.9.3</b> Use the PostgreSQL function</a></li>
<li class="chapter" data-level="8.9.4" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#monthly-sales-by-order-type-with-corrected-dates-relative-to-a-trend-line"><i class="fa fa-check"></i><b>8.9.4</b> Monthly Sales by Order Type with corrected dates – relative to a trend line</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="chapter-exploring-a-single-table.html"><a href="chapter-exploring-a-single-table.html#disconnect-from-the-database-and-stop-docker-3"><i class="fa fa-check"></i><b>8.10</b> Disconnect from the database and stop Docker</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html"><i class="fa fa-check"></i><b>9</b> Sales Forecasting</a><ul>
<li class="chapter" data-level="9.1" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#setup-1"><i class="fa fa-check"></i><b>9.1</b> Setup</a></li>
<li class="chapter" data-level="9.2" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#section"><i class="fa fa-check"></i><b>9.2</b> [1] 0</a></li>
<li class="chapter" data-level="9.3" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#exploring-the-sales-data"><i class="fa fa-check"></i><b>9.3</b> Exploring the sales data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#creating-a-tsibble"><i class="fa fa-check"></i><b>9.3.1</b> Creating a tsibble</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#exploring-the-data"><i class="fa fa-check"></i><b>9.3.2</b> Exploring the data</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#dont-know-how-to-automatically-pick-scale-for-object-of-type-yearmon.-defaulting-to-continuous."><i class="fa fa-check"></i><b>9.4</b> Don’t know how to automatically pick scale for object of type yearmon. Defaulting to continuous.</a></li>
<li class="chapter" data-level="9.5" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#warning-in-connection_releaseconnptr-already-disconnected"><i class="fa fa-check"></i><b>9.5</b> Warning in connection_release(<span>conn@ptr</span>): Already disconnected</a></li>
<li class="chapter" data-level="9.6" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#cleaning-up"><i class="fa fa-check"></i><b>9.6</b> Cleaning up</a></li>
<li class="chapter" data-level="9.7" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#warning-in-connection_releaseconnptr-already-disconnected-1"><i class="fa fa-check"></i><b>9.7</b> Warning in connection_release(<span>conn@ptr</span>): Already disconnected</a></li>
<li class="chapter" data-level="9.8" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#dont-know-how-to-automatically-pick-scale-for-object-of-type-yearmon.-defaulting-to-continuous.-1"><i class="fa fa-check"></i><b>9.8</b> Don’t know how to automatically pick scale for object of type yearmon. Defaulting to continuous.</a></li>
<li class="chapter" data-level="9.9" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#dont-know-how-to-automatically-pick-scale-for-object-of-type-yearmon.-defaulting-to-continuous.-2"><i class="fa fa-check"></i><b>9.9</b> Don’t know how to automatically pick scale for object of type yearmon. Defaulting to continuous.</a></li>
<li class="chapter" data-level="9.10" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#disconnect-from-the-database-and-stop-docker-4"><i class="fa fa-check"></i><b>9.10</b> Disconnect from the database and stop Docker</a></li>
<li class="chapter" data-level="9.11" data-path="chapter-sales-forecasting.html"><a href="chapter-sales-forecasting.html#warning-in-connection_releaseconnptr-already-disconnected-2"><i class="fa fa-check"></i><b>9.11</b> Warning in connection_release(<span>conn@ptr</span>): Already disconnected</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html"><i class="fa fa-check"></i><b>10</b> Lazy Evaluation and Lazy Queries</a><ul>
<li class="chapter" data-level="10.1" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#setup-2"><i class="fa fa-check"></i><b>10.1</b> Setup</a></li>
<li class="chapter" data-level="10.2" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#r-is-lazy-and-comes-with-guardrails"><i class="fa fa-check"></i><b>10.2</b> R is lazy and comes with guardrails</a><ul>
<li class="chapter" data-level="10.2.1" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy-loading"><i class="fa fa-check"></i><b>10.2.1</b> Lazy loading</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy-evaluation"><i class="fa fa-check"></i><b>10.2.2</b> Lazy evaluation</a></li>
<li class="chapter" data-level="10.2.3" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy-queries"><i class="fa fa-check"></i><b>10.2.3</b> Lazy Queries</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy-evaluation-and-lazy-queries"><i class="fa fa-check"></i><b>10.3</b> Lazy evaluation and lazy queries</a><ul>
<li class="chapter" data-level="10.3.1" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#create-a-black-box-query-for-experimentation"><i class="fa fa-check"></i><b>10.3.1</b> Create a black box query for experimentation</a></li>
<li class="chapter" data-level="10.3.2" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#experiment-overview"><i class="fa fa-check"></i><b>10.3.2</b> Experiment overview</a></li>
<li class="chapter" data-level="10.3.3" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_print"><i class="fa fa-check"></i><b>10.3.3</b> Q %&gt;% print()</a></li>
<li class="chapter" data-level="10.3.4" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_as-tibble"><i class="fa fa-check"></i><b>10.3.4</b> Q %&gt;% dplyr::as_tibble()</a></li>
<li class="chapter" data-level="10.3.5" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_head"><i class="fa fa-check"></i><b>10.3.5</b> Q %&gt;% head()</a></li>
<li class="chapter" data-level="10.3.6" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_tail"><i class="fa fa-check"></i><b>10.3.6</b> Q %&gt;% tail()</a></li>
<li class="chapter" data-level="10.3.7" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_length"><i class="fa fa-check"></i><b>10.3.7</b> Q %&gt;% length()</a></li>
<li class="chapter" data-level="10.3.8" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_str"><i class="fa fa-check"></i><b>10.3.8</b> Q %&gt;% str()</a></li>
<li class="chapter" data-level="10.3.9" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_nrow"><i class="fa fa-check"></i><b>10.3.9</b> Q %&gt;% nrow()</a></li>
<li class="chapter" data-level="10.3.10" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_tally"><i class="fa fa-check"></i><b>10.3.10</b> Q %&gt;% dplyr::tally()</a></li>
<li class="chapter" data-level="10.3.11" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_collect"><i class="fa fa-check"></i><b>10.3.11</b> Q %&gt;% dplyr::collect()</a></li>
<li class="chapter" data-level="10.3.12" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_plot-categories"><i class="fa fa-check"></i><b>10.3.12</b> Q %&gt;% ggplot</a></li>
<li class="chapter" data-level="10.3.13" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#lazy_q_show-query"><i class="fa fa-check"></i><b>10.3.13</b> Q %&gt;% dplyr::show_query()</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#disconnect-from-the-database-and-stop-docker-5"><i class="fa fa-check"></i><b>10.4</b> Disconnect from the database and stop Docker</a></li>
<li class="chapter" data-level="10.5" data-path="chapter-lazy-evaluation-queries.html"><a href="chapter-lazy-evaluation-queries.html#other-resources"><i class="fa fa-check"></i><b>10.5</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html"><i class="fa fa-check"></i><b>11</b> Lazy Evaluation and Execution Environment</a><ul>
<li class="chapter" data-level="11.1" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#setup-3"><i class="fa fa-check"></i><b>11.1</b> Setup</a><ul>
<li class="chapter" data-level="11.1.1" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#experiment-overview-1"><i class="fa fa-check"></i><b>11.1.1</b> Experiment overview</a></li>
<li class="chapter" data-level="11.1.2" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#time-based-execution-environment-issues"><i class="fa fa-check"></i><b>11.1.2</b> Time-based, execution environment issues</a></li>
<li class="chapter" data-level="11.1.3" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#lazy_q_build"><i class="fa fa-check"></i><b>11.1.3</b> Q %&gt;% <code>more dplyr</code></a></li>
<li class="chapter" data-level="11.1.4" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#interspersing-sql-and-dplyr"><i class="fa fa-check"></i><b>11.1.4</b> Interspersing SQL and dplyr</a></li>
<li class="chapter" data-level="11.1.5" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#many-handy-r-functions-cant-be-translated-to-sql"><i class="fa fa-check"></i><b>11.1.5</b> Many handy R functions can’t be translated to SQL</a></li>
<li class="chapter" data-level="11.1.6" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#further-lazy-execution-examples"><i class="fa fa-check"></i><b>11.1.6</b> Further lazy execution examples</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#disconnect-from-the-database-and-stop-docker-6"><i class="fa fa-check"></i><b>11.2</b> Disconnect from the database and stop Docker</a></li>
<li class="chapter" data-level="11.3" data-path="chapter-lazy-evaluation-and-timing.html"><a href="chapter-lazy-evaluation-and-timing.html#other-resources-1"><i class="fa fa-check"></i><b>11.3</b> Other resources</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html"><i class="fa fa-check"></i><b>12</b> Leveraging Database Views</a><ul>
<li class="chapter" data-level="12.1" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html#setup-our-standard-working-environment-1"><i class="fa fa-check"></i><b>12.1</b> Setup our standard working environment</a></li>
<li class="chapter" data-level="12.2" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html#the-role-of-database-views"><i class="fa fa-check"></i><b>12.2</b> The role of database <code>views</code></a><ul>
<li class="chapter" data-level="12.2.1" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html#why-database-views-are-useful"><i class="fa fa-check"></i><b>12.2.1</b> Why database <code>views</code> are useful</a></li>
<li class="chapter" data-level="12.2.2" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html#rely-on-and-be-critical-of-views"><i class="fa fa-check"></i><b>12.2.2</b> Rely on <strong>and</strong> be critical of <code>views</code></a></li>
<li class="chapter" data-level="12.2.3" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html#how-to-unpack-and-inspect-a-view"><i class="fa fa-check"></i><b>12.2.3</b> How to unpack and inspect a <code>view</code></a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html#reproduce-the-view-with-dplyr"><i class="fa fa-check"></i><b>12.3</b> Reproduce the <code>view</code> with dplyr</a><ul>
<li class="chapter" data-level="12.3.1" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html#compare-the-two-versions"><i class="fa fa-check"></i><b>12.3.1</b> Compare the two versions</a></li>
<li class="chapter" data-level="12.3.2" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html#revise-the-view"><i class="fa fa-check"></i><b>12.3.2</b> Revise the view</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="chapter-leveraging-database-views.html"><a href="chapter-leveraging-database-views.html#save-a-view-in-the-database"><i class="fa fa-check"></i><b>12.4</b> Save a <code>view</code> in the database</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html"><i class="fa fa-check"></i><b>13</b> Getting metadata about and from PostgreSQL</a><ul>
<li class="chapter" data-level="13.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#views-trick-parked-here-for-the-time-being"><i class="fa fa-check"></i><b>13.1</b> Views trick parked here for the time being</a><ul>
<li class="chapter" data-level="13.1.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#explore-the-vsalelsperson-and-vsalespersonsalesbyfiscalyearsdata-views"><i class="fa fa-check"></i><b>13.1.1</b> Explore the vsalelsperson and vsalespersonsalesbyfiscalyearsdata views</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#select-s.businessentityid"><i class="fa fa-check"></i><b>13.2</b> SELECT s.businessentityid,</a></li>
<li class="chapter" data-level="13.3" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#p.title"><i class="fa fa-check"></i><b>13.3</b> p.title,</a></li>
<li class="chapter" data-level="13.4" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#p.firstname"><i class="fa fa-check"></i><b>13.4</b> p.firstname,</a></li>
<li class="chapter" data-level="13.5" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#p.middlename"><i class="fa fa-check"></i><b>13.5</b> p.middlename,</a></li>
<li class="chapter" data-level="13.6" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#p.lastname"><i class="fa fa-check"></i><b>13.6</b> p.lastname,</a></li>
<li class="chapter" data-level="13.7" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#p.suffix"><i class="fa fa-check"></i><b>13.7</b> p.suffix,</a></li>
<li class="chapter" data-level="13.8" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#e.jobtitle"><i class="fa fa-check"></i><b>13.8</b> e.jobtitle,</a></li>
<li class="chapter" data-level="13.9" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#pp.phonenumber"><i class="fa fa-check"></i><b>13.9</b> pp.phonenumber,</a></li>
<li class="chapter" data-level="13.10" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#pnt.name-as-phonenumbertype"><i class="fa fa-check"></i><b>13.10</b> pnt.name AS phonenumbertype,</a></li>
<li class="chapter" data-level="13.11" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#ea.emailaddress"><i class="fa fa-check"></i><b>13.11</b> ea.emailaddress,</a></li>
<li class="chapter" data-level="13.12" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#p.emailpromotion"><i class="fa fa-check"></i><b>13.12</b> p.emailpromotion,</a></li>
<li class="chapter" data-level="13.13" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#a.addressline1"><i class="fa fa-check"></i><b>13.13</b> a.addressline1,</a></li>
<li class="chapter" data-level="13.14" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#a.addressline2"><i class="fa fa-check"></i><b>13.14</b> a.addressline2,</a></li>
<li class="chapter" data-level="13.15" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#a.city"><i class="fa fa-check"></i><b>13.15</b> a.city,</a></li>
<li class="chapter" data-level="13.16" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#sp.name-as-stateprovincename"><i class="fa fa-check"></i><b>13.16</b> sp.name AS stateprovincename,</a></li>
<li class="chapter" data-level="13.17" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#a.postalcode"><i class="fa fa-check"></i><b>13.17</b> a.postalcode,</a></li>
<li class="chapter" data-level="13.18" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#cr.name-as-countryregionname"><i class="fa fa-check"></i><b>13.18</b> cr.name AS countryregionname,</a></li>
<li class="chapter" data-level="13.19" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#st.name-as-territoryname"><i class="fa fa-check"></i><b>13.19</b> st.name AS territoryname,</a></li>
<li class="chapter" data-level="13.20" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#st.group-as-territorygroup"><i class="fa fa-check"></i><b>13.20</b> st.“group” AS territorygroup,</a></li>
<li class="chapter" data-level="13.21" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#s.salesquota"><i class="fa fa-check"></i><b>13.21</b> s.salesquota,</a></li>
<li class="chapter" data-level="13.22" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#s.salesytd"><i class="fa fa-check"></i><b>13.22</b> s.salesytd,</a></li>
<li class="chapter" data-level="13.23" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#s.saleslastyear"><i class="fa fa-check"></i><b>13.23</b> s.saleslastyear</a></li>
<li class="chapter" data-level="13.24" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#from-sales.salesperson-s"><i class="fa fa-check"></i><b>13.24</b> FROM sales.salesperson s</a></li>
<li class="chapter" data-level="13.25" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#join-humanresources.employee-e-on-e.businessentityid-s.businessentityid"><i class="fa fa-check"></i><b>13.25</b> JOIN humanresources.employee e ON e.businessentityid = s.businessentityid</a></li>
<li class="chapter" data-level="13.26" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#join-person.person-p-on-p.businessentityid-s.businessentityid"><i class="fa fa-check"></i><b>13.26</b> JOIN person.person p ON p.businessentityid = s.businessentityid</a></li>
<li class="chapter" data-level="13.27" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#join-person.businessentityaddress-bea-on-bea.businessentityid-s.businessentityid"><i class="fa fa-check"></i><b>13.27</b> JOIN person.businessentityaddress bea ON bea.businessentityid = s.businessentityid</a></li>
<li class="chapter" data-level="13.28" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#join-person.address-a-on-a.addressid-bea.addressid"><i class="fa fa-check"></i><b>13.28</b> JOIN person.address a ON a.addressid = bea.addressid</a></li>
<li class="chapter" data-level="13.29" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#join-person.stateprovince-sp-on-sp.stateprovinceid-a.stateprovinceid"><i class="fa fa-check"></i><b>13.29</b> JOIN person.stateprovince sp ON sp.stateprovinceid = a.stateprovinceid</a></li>
<li class="chapter" data-level="13.30" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#join-person.countryregion-cr-on-cr.countryregioncodetext-sp.countryregioncodetext"><i class="fa fa-check"></i><b>13.30</b> JOIN person.countryregion cr ON cr.countryregioncode::text = sp.countryregioncode::text</a></li>
<li class="chapter" data-level="13.31" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#left-join-sales.salesterritory-st-on-st.territoryid-s.territoryid"><i class="fa fa-check"></i><b>13.31</b> LEFT JOIN sales.salesterritory st ON st.territoryid = s.territoryid</a></li>
<li class="chapter" data-level="13.32" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#left-join-person.emailaddress-ea-on-ea.businessentityid-p.businessentityid"><i class="fa fa-check"></i><b>13.32</b> LEFT JOIN person.emailaddress ea ON ea.businessentityid = p.businessentityid</a></li>
<li class="chapter" data-level="13.33" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#left-join-person.personphone-pp-on-pp.businessentityid-p.businessentityid"><i class="fa fa-check"></i><b>13.33</b> LEFT JOIN person.personphone pp ON pp.businessentityid = p.businessentityid</a></li>
<li class="chapter" data-level="13.34" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#left-join-person.phonenumbertype-pnt-on-pnt.phonenumbertypeid-pp.phonenumbertypeid"><i class="fa fa-check"></i><b>13.34</b> LEFT JOIN person.phonenumbertype pnt ON pnt.phonenumbertypeid = pp.phonenumbertypeid;</a></li>
<li class="chapter" data-level="13.35" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#pg_get_viewdef"><i class="fa fa-check"></i><b>13.35</b> pg_get_viewdef</a></li>
<li class="chapter" data-level="13.36" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#select-granular.salespersonidgranular.fullnamegranular.jobtitlegranular.salesterritorysumgranular.subtotal-as-salestotalgranular.fiscalyearfrom-select-soh.salespersonidp.firstnametext-text-coalescep.middlenametext-texttext-p.lastnametext-as-fullnamee.jobtitlest.name-as-salesterritorysoh.subtotaldate_partyeartext-soh.orderdate-6-monsinterval-as-fiscalyearfrom-sales.salesperson-spjoin-sales.salesorderheader-soh-on-sp.businessentityid-soh.salespersonidjoin-sales.salesterritory-st-on-sp.territoryid-st.territoryidjoin-humanresources.employee-e-on-soh.salespersonid-e.businessentityidjoin-person.person-p-on-p.businessentityid-sp.businessentityid-granulargroup-by-granular.salespersonid-granular.fullname-granular.jobtitle-granular.salesterritory-granular.fiscalyear"><i class="fa fa-check"></i><b>13.36</b> 1 SELECT granular.salespersonid,granular.fullname,granular.jobtitle,granular.salesterritory,sum(granular.subtotal) AS salestotal,granular.fiscalyearFROM ( SELECT soh.salespersonid,((p.firstname::text || ’ ‘::text) || COALESCE(p.middlename::text ||’ ‘::text,’‘::text)) || p.lastname::text AS fullname,e.jobtitle,st.name AS salesterritory,soh.subtotal,date_part(’year’::text, soh.orderdate + ‘6 mons’::interval) AS fiscalyearFROM sales.salesperson spJOIN sales.salesorderheader soh ON sp.businessentityid = soh.salespersonidJOIN sales.salesterritory st ON sp.territoryid = st.territoryidJOIN humanresources.employee e ON soh.salespersonid = e.businessentityidJOIN person.person p ON p.businessentityid = sp.businessentityid) granularGROUP BY granular.salespersonid, granular.fullname, granular.jobtitle, granular.salesterritory, granular.fiscalyear;</a></li>
<li class="chapter" data-level="13.37" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#database-contents-and-structure"><i class="fa fa-check"></i><b>13.37</b> Database contents and structure</a><ul>
<li class="chapter" data-level="13.37.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#database-structure"><i class="fa fa-check"></i><b>13.37.1</b> Database structure</a></li>
<li class="chapter" data-level="13.37.2" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#contents-of-the-information_schema"><i class="fa fa-check"></i><b>13.37.2</b> Contents of the <code>information_schema</code></a></li>
<li class="chapter" data-level="13.37.3" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#what-tables-are-in-the-database"><i class="fa fa-check"></i><b>13.37.3</b> What tables are in the database?</a></li>
<li class="chapter" data-level="13.37.4" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#digging-into-the-information_schema"><i class="fa fa-check"></i><b>13.37.4</b> Digging into the <code>information_schema</code></a></li>
</ul></li>
<li class="chapter" data-level="13.38" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#what-columns-do-those-tables-contain"><i class="fa fa-check"></i><b>13.38</b> What columns do those tables contain?</a></li>
<li class="chapter" data-level="13.39" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#observations-2961"><i class="fa fa-check"></i><b>13.39</b> Observations: 2,961</a></li>
<li class="chapter" data-level="13.40" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#variables-7"><i class="fa fa-check"></i><b>13.40</b> Variables: 7</a></li>
<li><a href="chapter-postgresql-metadata.html#table_catalog-adventureworks-adventureworks-adventu-table_name-pg_procpg_procpg_procpg_proc-column_name-pronamepronamespaceproownerprol"><span class="toc-section-number">13.41</span> $ table_catalog <chr> “adventureworks”, “adventureworks”, “adventu…
## $ table_name <chr>”pg_proc“,”pg_proc“,”pg_proc“,”pg_proc“, …
## $ column_name <chr>”proname“,”pronamespace“,”proowner“,”prol…</a></li>
<li class="chapter" data-level="13.42" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#data_type-name-oid-oid-oid-real-242"><i class="fa fa-check"></i><b>13.42</b> $ data_type <chr> “name”, “oid”, “oid”, “oid”, “real (24,2)”, …</a></li>
<li class="chapter" data-level="13.43" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#ordinal_position-1-2-3-4-5-6-7-8-9-10-11-12-13-1"><i class="fa fa-check"></i><b>13.43</b> $ ordinal_position <int> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 1…</a></li>
<li class="chapter" data-level="13.44" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#character_maximum_length-na-na-na-na-na-na-na-na-na-na-na"><i class="fa fa-check"></i><b>13.44</b> $ character_maximum_length <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …</a></li>
<li class="chapter" data-level="13.45" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#column_default-na-na-na-na-na-na-na-na-na-na-na"><i class="fa fa-check"></i><b>13.45</b> $ column_default <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, …</a><ul>
<li class="chapter" data-level="13.45.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#what-is-the-difference-between-a-view-and-a-base-table"><i class="fa fa-check"></i><b>13.45.1</b> What is the difference between a <code>VIEW</code> and a <code>BASE TABLE</code>?</a></li>
<li class="chapter" data-level="13.45.2" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#what-data-types-are-found-in-the-database"><i class="fa fa-check"></i><b>13.45.2</b> What data types are found in the database?</a></li>
</ul></li>
<li class="chapter" data-level="13.46" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#characterizing-how-things-are-named"><i class="fa fa-check"></i><b>13.46</b> Characterizing how things are named</a><ul>
<li class="chapter" data-level="13.46.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#counting-columns-and-name-reuse"><i class="fa fa-check"></i><b>13.46.1</b> Counting columns and name reuse</a></li>
</ul></li>
<li class="chapter" data-level="13.47" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#a-tibble-6-x-2"><i class="fa fa-check"></i><b>13.47</b> # A tibble: 6 x 2</a></li>
<li class="chapter" data-level="13.48" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#column_name-n"><i class="fa fa-check"></i><b>13.48</b> column_name n</a></li>
<li class="chapter" data-level="13.49" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#section-1"><i class="fa fa-check"></i><b>13.49</b> <chr> <int></a></li>
<li class="chapter" data-level="13.50" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#modifieddate-140"><i class="fa fa-check"></i><b>13.50</b> 1 modifieddate 140</a></li>
<li class="chapter" data-level="13.51" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#rowguid-61"><i class="fa fa-check"></i><b>13.51</b> 2 rowguid 61</a></li>
<li class="chapter" data-level="13.52" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#id-60"><i class="fa fa-check"></i><b>13.52</b> 3 id 60</a></li>
<li class="chapter" data-level="13.53" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#name-59"><i class="fa fa-check"></i><b>13.53</b> 4 name 59</a></li>
<li class="chapter" data-level="13.54" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#businessentityid-49"><i class="fa fa-check"></i><b>13.54</b> 5 businessentityid 49</a></li>
<li class="chapter" data-level="13.55" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#productid-32"><i class="fa fa-check"></i><b>13.55</b> 6 productid 32</a></li>
<li class="chapter" data-level="13.56" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#a-tibble-1-x-1"><i class="fa fa-check"></i><b>13.56</b> # A tibble: 1 x 1</a></li>
<li class="chapter" data-level="13.57" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#n"><i class="fa fa-check"></i><b>13.57</b> n</a></li>
<li class="chapter" data-level="13.58" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#section-2"><i class="fa fa-check"></i><b>13.58</b> <int></a></li>
<li class="chapter" data-level="13.59" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#section-3"><i class="fa fa-check"></i><b>13.59</b> 1 882</a></li>
<li class="chapter" data-level="13.60" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#database-keys"><i class="fa fa-check"></i><b>13.60</b> Database keys</a><ul>
<li class="chapter" data-level="13.60.1" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#direct-sql"><i class="fa fa-check"></i><b>13.60.1</b> Direct SQL</a></li>
</ul></li>
<li class="chapter" data-level="13.61" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#observations-467838"><i class="fa fa-check"></i><b>13.61</b> Observations: 467,838</a></li>
<li class="chapter" data-level="13.62" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#variables-3"><i class="fa fa-check"></i><b>13.62</b> Variables: 3</a></li>
<li><a href="chapter-postgresql-metadata.html#table_name-adventureworks.hr.d-adventureworks.hr.d-adventurewo-conname-fk_salesorderdetail_specialofferproduct_specialofferidpro"><span class="toc-section-number">13.63</span> $ table_name <chr> “adventureworks.hr.d”, “adventureworks.hr.d”, “adventurewo…
## $ conname <chr>”FK_SalesOrderDetail_SpecialOfferProduct_SpecialOfferIDPro…</a></li>
<li><a href="chapter-postgresql-metadata.html#condef-foreign-key-specialofferid-productid-references-sales.-observations-0-variables-3-table_from-conname-pg_get_constraintdef-1-0-database-keys-with-dplyr-observations-190-variables-6-table_name-addressaddressaddresstypebillofmaterial"><span class="toc-section-number">13.64</span> $ condef <chr> “FOREIGN KEY (specialofferid, productid) REFERENCES sales.…
## Observations: 0
## Variables: 3
## $ table_from <chr>
## $ conname <chr>
## $ pg_get_constraintdef <chr>
## [1] 0
### Database keys with dplyr
## Observations: 190
## Variables: 6
## $ table_name <chr>”address“,”address“,”addresstype“,”billofmaterial…</a></li>
<li><a href="chapter-postgresql-metadata.html#table_type-base-table-base-table-base-table-base-tabl-constraint_name-fk_address_stateprovince_stateprovinceidpk_addr"><span class="toc-section-number">13.65</span> $ table_type <chr> “BASE TABLE”, “BASE TABLE”, “BASE TABLE”, “BASE TABL…
## $ constraint_name <chr>”FK_Address_StateProvince_StateProvinceID“,”PK_Addr…</a></li>
<li><a href="chapter-postgresql-metadata.html#constraint_type-foreign-key-primary-key-primary-key-foreig-column_name-stateprovinceidaddressidaddresstypeidco"><span class="toc-section-number">13.66</span> $ constraint_type <chr> “FOREIGN KEY”, “PRIMARY KEY”, “PRIMARY KEY”, “FOREIG…
## $ column_name <chr>”stateprovinceid“,”addressid“,”addresstypeid“,”co…</a></li>
<li class="chapter" data-level="13.67" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#ordinal_position-1-1-1-1-1-1-1-1-1-1-1-1-3-2-1-1-1-2"><i class="fa fa-check"></i><b>13.67</b> $ ordinal_position <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 3, 2, 1, 1, 1, 2…</a></li>
<li class="chapter" data-level="13.68" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#conname-connamespace-contype-condeferrable-condeferred"><i class="fa fa-check"></i><b>13.68</b> conname connamespace contype condeferrable condeferred</a></li>
<li class="chapter" data-level="13.69" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#cardinal_number_domain_check-12771-c-false-false"><i class="fa fa-check"></i><b>13.69</b> 1 cardinal_number_domain_check 12771 c FALSE FALSE</a></li>
<li class="chapter" data-level="13.70" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#yes_or_no_check-12771-c-false-false"><i class="fa fa-check"></i><b>13.70</b> 2 yes_or_no_check 12771 c FALSE FALSE</a></li>
<li class="chapter" data-level="13.71" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#ck_employee_birthdate-16386-c-false-false"><i class="fa fa-check"></i><b>13.71</b> 3 CK_Employee_BirthDate 16386 c FALSE FALSE</a></li>
<li class="chapter" data-level="13.72" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#ck_employee_gender-16386-c-false-false"><i class="fa fa-check"></i><b>13.72</b> 4 CK_Employee_Gender 16386 c FALSE FALSE</a></li>
<li class="chapter" data-level="13.73" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#ck_employee_hiredate-16386-c-false-false"><i class="fa fa-check"></i><b>13.73</b> 5 CK_Employee_HireDate 16386 c FALSE FALSE</a></li>
<li class="chapter" data-level="13.74" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#ck_employee_maritalstatus-16386-c-false-false"><i class="fa fa-check"></i><b>13.74</b> 6 CK_Employee_MaritalStatus 16386 c FALSE FALSE</a></li>
<li class="chapter" data-level="13.75" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#convalidated-conrelid-contypid-conindid-conparentid-confrelid-confupdtype"><i class="fa fa-check"></i><b>13.75</b> convalidated conrelid contypid conindid conparentid confrelid confupdtype</a></li>
<li class="chapter" data-level="13.76" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-0-12785-0-0-0"><i class="fa fa-check"></i><b>13.76</b> 1 TRUE 0 12785 0 0 0</a></li>
<li class="chapter" data-level="13.77" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-0-12797-0-0-0"><i class="fa fa-check"></i><b>13.77</b> 2 TRUE 0 12797 0 0 0</a></li>
<li class="chapter" data-level="13.78" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-16450-0-0-0-0"><i class="fa fa-check"></i><b>13.78</b> 3 TRUE 16450 0 0 0 0</a></li>
<li class="chapter" data-level="13.79" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-16450-0-0-0-0-1"><i class="fa fa-check"></i><b>13.79</b> 4 TRUE 16450 0 0 0 0</a></li>
<li class="chapter" data-level="13.80" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-16450-0-0-0-0-2"><i class="fa fa-check"></i><b>13.80</b> 5 TRUE 16450 0 0 0 0</a></li>
<li class="chapter" data-level="13.81" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-16450-0-0-0-0-3"><i class="fa fa-check"></i><b>13.81</b> 6 TRUE 16450 0 0 0 0</a></li>
<li class="chapter" data-level="13.82" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#confdeltype-confmatchtype-conislocal-coninhcount-connoinherit-conkey-confkey"><i class="fa fa-check"></i><b>13.82</b> confdeltype confmatchtype conislocal coninhcount connoinherit conkey confkey</a></li>
<li class="chapter" data-level="13.83" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-0-false"><i class="fa fa-check"></i><b>13.83</b> 1 TRUE 0 FALSE <NA> <NA></a></li>
<li class="chapter" data-level="13.84" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-0-false-1"><i class="fa fa-check"></i><b>13.84</b> 2 TRUE 0 FALSE <NA> <NA></a></li>
<li class="chapter" data-level="13.85" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-0-false-5"><i class="fa fa-check"></i><b>13.85</b> 3 TRUE 0 FALSE {5} <NA></a></li>
<li class="chapter" data-level="13.86" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-0-false-7"><i class="fa fa-check"></i><b>13.86</b> 4 TRUE 0 FALSE {7} <NA></a></li>
<li class="chapter" data-level="13.87" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-0-false-8"><i class="fa fa-check"></i><b>13.87</b> 5 TRUE 0 FALSE {8} <NA></a></li>
<li class="chapter" data-level="13.88" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#true-0-false-6"><i class="fa fa-check"></i><b>13.88</b> 6 TRUE 0 FALSE {6} <NA></a></li>
<li class="chapter" data-level="13.89" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#conpfeqop-conppeqop-conffeqop-conexclop"><i class="fa fa-check"></i><b>13.89</b> conpfeqop conppeqop conffeqop conexclop</a></li>
<li class="chapter" data-level="13.90" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#section-4"><i class="fa fa-check"></i><b>13.90</b> 1 <NA> <NA> <NA> <NA></a></li>
<li class="chapter" data-level="13.91" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#section-5"><i class="fa fa-check"></i><b>13.91</b> 2 <NA> <NA> <NA> <NA></a></li>
<li class="chapter" data-level="13.92" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#section-6"><i class="fa fa-check"></i><b>13.92</b> 3 <NA> <NA> <NA> <NA></a></li>
<li class="chapter" data-level="13.93" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#section-7"><i class="fa fa-check"></i><b>13.93</b> 4 <NA> <NA> <NA> <NA></a></li>
<li class="chapter" data-level="13.94" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#section-8"><i class="fa fa-check"></i><b>13.94</b> 5 <NA> <NA> <NA> <NA></a></li>
<li class="chapter" data-level="13.95" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#section-9"><i class="fa fa-check"></i><b>13.95</b> 6 <NA> <NA> <NA> <NA></a></li>
<li class="chapter" data-level="13.96" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#conbin"><i class="fa fa-check"></i><b>13.96</b> conbin</a></li>
<li class="chapter" data-level="13.97" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#opexpr-opno-525-opfuncid-150-opresulttype-16-opretset-false-opcollid-0-inputcollid-0-args-coercetodomainvalue-typeid-23-typemod--1-collation-0-location-195-const-consttype-23-consttypmod--1-constcollid-0-constlen-4-constbyval-true-constisnull-false-location-204-constvalue-4-0-0-0-0-0-0-0-0-location-201"><i class="fa fa-check"></i><b>13.97</b> 1 {OPEXPR :opno 525 :opfuncid 150 :opresulttype 16 :opretset false :opcollid 0 :inputcollid 0 :args ({COERCETODOMAINVALUE :typeId 23 :typeMod -1 :collation 0 :location 195} {CONST :consttype 23 :consttypmod -1 :constcollid 0 :constlen 4 :constbyval true :constisnull false :location 204 :constvalue 4 [ 0 0 0 0 0 0 0 0 ]}) :location 201}</a></li>
<li class="chapter" data-level="13.98" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#scalararrayopexpr-opno-98-opfuncid-67-useor-true-inputcollid-100-args-relabeltype-arg-coercetodomainvalue-typeid-1043-typemod-7-collation-100-location-121-resulttype-25-resulttypmod--1-resultcollid-100-relabelformat-2-location--1-arraycoerceexpr-arg-array-array_typeid-1015-array_collid-100-element_typeid-1043-elements-const-consttype-1043-consttypmod--1-constcollid-100-constlen--1-constbyval-false-constisnull-false-location-131-constvalue-7-28-0-0-0-89-69-83-const-consttype-1043-consttypmod--1-constcollid-100-constlen--1-constbyval-false-constisnull-false-location-138-constvalue-6-24-0-0-0-78-79-multidims-false-location--1-elemexpr-relabeltype-arg-casetestexpr-typeid-1043-typemod--1-collation-0-resulttype-25-resulttypmod--1-resultcollid-100-relabelformat-2-location--1-resulttype-1009-resulttypmod--1-resultcollid-100-coerceformat-2-location--1-location-127"><i class="fa fa-check"></i><b>13.98</b> 2 {SCALARARRAYOPEXPR :opno 98 :opfuncid 67 :useOr true :inputcollid 100 :args ({RELABELTYPE :arg {COERCETODOMAINVALUE :typeId 1043 :typeMod 7 :collation 100 :location 121} :resulttype 25 :resulttypmod -1 :resultcollid 100 :relabelformat 2 :location -1} {ARRAYCOERCEEXPR :arg {ARRAY :array_typeid 1015 :array_collid 100 :element_typeid 1043 :elements ({CONST :consttype 1043 :consttypmod -1 :constcollid 100 :constlen -1 :constbyval false :constisnull false :location 131 :constvalue 7 [ 28 0 0 0 89 69 83 ]} {CONST :consttype 1043 :consttypmod -1 :constcollid 100 :constlen -1 :constbyval false :constisnull false :location 138 :constvalue 6 [ 24 0 0 0 78 79 ]}) :multidims false :location -1} :elemexpr {RELABELTYPE :arg {CASETESTEXPR :typeId 1043 :typeMod -1 :collation 0} :resulttype 25 :resulttypmod -1 :resultcollid 100 :relabelformat 2 :location -1} :resulttype 1009 :resulttypmod -1 :resultcollid 100 :coerceformat 2 :location -1}) :location 127}</a></li>
<li class="chapter" data-level="13.99" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#boolexpr-boolop-and-args-opexpr-opno-1098-opfuncid-1090-opresulttype-16-opretset-false-opcollid-0-inputcollid-0-args-var-varno-1-varattno-5-vartype-1082-vartypmod--1-varcollid-0-varlevelsup-0-varnoold-1-varoattno-5-location-804-const-consttype-1082-consttypmod--1-constcollid-0-constlen-4-constbyval-true-constisnull-false-location-817-constvalue-4-33--100--1--1--1--1--1--1-location-814-opexpr-opno-2359-opfuncid-2352-opresulttype-16-opretset-false-opcollid-0-inputcollid-0-args-var-varno-1-varattno-5-vartype-1082-vartypmod--1-varcollid-0-varlevelsup-0-varnoold-1-varoattno-5-location-842-opexpr-opno-1329-opfuncid-1190-opresulttype-1184-opretset-false-opcollid-0-inputcollid-0-args-funcexpr-funcid-1299-funcresulttype-1184-funcretset-false-funcvariadic-false-funcformat-0-funccollid-0-inputcollid-0-args-location-856-const-consttype-1186-consttypmod--1-constcollid-0-constlen-16-constbyval-false-constisnull-false-location-864-constvalue-16-0-0-0-0-0-0-0-0-0-0-0-0--40-0-0-0-location-862-location-852-location-837"><i class="fa fa-check"></i><b>13.99</b> 3 {BOOLEXPR :boolop and :args ({OPEXPR :opno 1098 :opfuncid 1090 :opresulttype 16 :opretset false :opcollid 0 :inputcollid 0 :args ({VAR :varno 1 :varattno 5 :vartype 1082 :vartypmod -1 :varcollid 0 :varlevelsup 0 :varnoold 1 :varoattno 5 :location 804} {CONST :consttype 1082 :consttypmod -1 :constcollid 0 :constlen 4 :constbyval true :constisnull false :location 817 :constvalue 4 [ 33 -100 -1 -1 -1 -1 -1 -1 ]}) :location 814} {OPEXPR :opno 2359 :opfuncid 2352 :opresulttype 16 :opretset false :opcollid 0 :inputcollid 0 :args ({VAR :varno 1 :varattno 5 :vartype 1082 :vartypmod -1 :varcollid 0 :varlevelsup 0 :varnoold 1 :varoattno 5 :location 842} {OPEXPR :opno 1329 :opfuncid 1190 :opresulttype 1184 :opretset false :opcollid 0 :inputcollid 0 :args ({FUNCEXPR :funcid 1299 :funcresulttype 1184 :funcretset false :funcvariadic false :funcformat 0 :funccollid 0 :inputcollid 0 :args &lt;&gt; :location 856} {CONST :consttype 1186 :consttypmod -1 :constcollid 0 :constlen 16 :constbyval false :constisnull false :location 864 :constvalue 16 [ 0 0 0 0 0 0 0 0 0 0 0 0 -40 0 0 0 ]}) :location 862}) :location 852}) :location 837}</a></li>
<li class="chapter" data-level="13.100" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#scalararrayopexpr-opno-98-opfuncid-67-useor-true-inputcollid-100-args-funcexpr-funcid-871-funcresulttype-25-funcretset-false-funcvariadic-false-funcformat-0-funccollid-100-inputcollid-100-args-funcexpr-funcid-401-funcresulttype-25-funcretset-false-funcvariadic-false-funcformat-1-funccollid-100-inputcollid-100-args-var-varno-1-varattno-7-vartype-1042-vartypmod-5-varcollid-100-varlevelsup-0-varnoold-1-varoattno-7-location-941-location-948-location-934-array-array_typeid-1009-array_collid-100-element_typeid-25-elements-const-consttype-25-consttypmod--1-constcollid-100-constlen--1-constbyval-false-constisnull-false-location-969-constvalue-5-20-0-0-0-77-const-consttype-25-consttypmod--1-constcollid-100-constlen--1-constbyval-false-constisnull-false-location-980-constvalue-5-20-0-0-0-70-multidims-false-location-963-location-956"><i class="fa fa-check"></i><b>13.100</b> 4 {SCALARARRAYOPEXPR :opno 98 :opfuncid 67 :useOr true :inputcollid 100 :args ({FUNCEXPR :funcid 871 :funcresulttype 25 :funcretset false :funcvariadic false :funcformat 0 :funccollid 100 :inputcollid 100 :args ({FUNCEXPR :funcid 401 :funcresulttype 25 :funcretset false :funcvariadic false :funcformat 1 :funccollid 100 :inputcollid 100 :args ({VAR :varno 1 :varattno 7 :vartype 1042 :vartypmod 5 :varcollid 100 :varlevelsup 0 :varnoold 1 :varoattno 7 :location 941}) :location 948}) :location 934} {ARRAY :array_typeid 1009 :array_collid 100 :element_typeid 25 :elements ({CONST :consttype 25 :consttypmod -1 :constcollid 100 :constlen -1 :constbyval false :constisnull false :location 969 :constvalue 5 [ 20 0 0 0 77 ]} {CONST :consttype 25 :consttypmod -1 :constcollid 100 :constlen -1 :constbyval false :constisnull false :location 980 :constvalue 5 [ 20 0 0 0 70 ]}) :multidims false :location 963}) :location 956}</a></li>
<li class="chapter" data-level="13.101" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#boolexpr-boolop-and-args-opexpr-opno-1098-opfuncid-1090-opresulttype-16-opretset-false-opcollid-0-inputcollid-0-args-var-varno-1-varattno-8-vartype-1082-vartypmod--1-varcollid-0-varlevelsup-0-varnoold-1-varoattno-8-location-1042-const-consttype-1082-consttypmod--1-constcollid-0-constlen-4-constbyval-true-constisnull-false-location-1054-constvalue-4-1--5--1--1--1--1--1--1-location-1051-opexpr-opno-2359-opfuncid-2352-opresulttype-16-opretset-false-opcollid-0-inputcollid-0-args-var-varno-1-varattno-8-vartype-1082-vartypmod--1-varcollid-0-varlevelsup-0-varnoold-1-varoattno-8-location-1079-opexpr-opno-1327-opfuncid-1189-opresulttype-1184-opretset-false-opcollid-0-inputcollid-0-args-funcexpr-funcid-1299-funcresulttype-1184-funcretset-false-funcvariadic-false-funcformat-0-funccollid-0-inputcollid-0-args-location-1092-const-consttype-1186-consttypmod--1-constcollid-0-constlen-16-constbyval-false-constisnull-false-location-1100-constvalue-16-0-0-0-0-0-0-0-0-1-0-0-0-0-0-0-0-location-1098-location-1088-location-1074"><i class="fa fa-check"></i><b>13.101</b> 5 {BOOLEXPR :boolop and :args ({OPEXPR :opno 1098 :opfuncid 1090 :opresulttype 16 :opretset false :opcollid 0 :inputcollid 0 :args ({VAR :varno 1 :varattno 8 :vartype 1082 :vartypmod -1 :varcollid 0 :varlevelsup 0 :varnoold 1 :varoattno 8 :location 1042} {CONST :consttype 1082 :consttypmod -1 :constcollid 0 :constlen 4 :constbyval true :constisnull false :location 1054 :constvalue 4 [ 1 -5 -1 -1 -1 -1 -1 -1 ]}) :location 1051} {OPEXPR :opno 2359 :opfuncid 2352 :opresulttype 16 :opretset false :opcollid 0 :inputcollid 0 :args ({VAR :varno 1 :varattno 8 :vartype 1082 :vartypmod -1 :varcollid 0 :varlevelsup 0 :varnoold 1 :varoattno 8 :location 1079} {OPEXPR :opno 1327 :opfuncid 1189 :opresulttype 1184 :opretset false :opcollid 0 :inputcollid 0 :args ({FUNCEXPR :funcid 1299 :funcresulttype 1184 :funcretset false :funcvariadic false :funcformat 0 :funccollid 0 :inputcollid 0 :args &lt;&gt; :location 1092} {CONST :consttype 1186 :consttypmod -1 :constcollid 0 :constlen 16 :constbyval false :constisnull false :location 1100 :constvalue 16 [ 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 ]}) :location 1098}) :location 1088}) :location 1074}</a></li>
<li class="chapter" data-level="13.102" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#scalararrayopexpr-opno-98-opfuncid-67-useor-true-inputcollid-100-args-funcexpr-funcid-871-funcresulttype-25-funcretset-false-funcvariadic-false-funcformat-0-funccollid-100-inputcollid-100-args-funcexpr-funcid-401-funcresulttype-25-funcretset-false-funcvariadic-false-funcformat-1-funccollid-100-inputcollid-100-args-var-varno-1-varattno-6-vartype-1042-vartypmod-5-varcollid-100-varlevelsup-0-varnoold-1-varoattno-6-location-1181-location-1195-location-1174-array-array_typeid-1009-array_collid-100-element_typeid-25-elements-const-consttype-25-consttypmod--1-constcollid-100-constlen--1-constbyval-false-constisnull-false-location-1216-constvalue-5-20-0-0-0-77-const-consttype-25-consttypmod--1-constcollid-100-constlen--1-constbyval-false-constisnull-false-location-1227-constvalue-5-20-0-0-0-83-multidims-false-location-1210-location-1203"><i class="fa fa-check"></i><b>13.102</b> 6 {SCALARARRAYOPEXPR :opno 98 :opfuncid 67 :useOr true :inputcollid 100 :args ({FUNCEXPR :funcid 871 :funcresulttype 25 :funcretset false :funcvariadic false :funcformat 0 :funccollid 100 :inputcollid 100 :args ({FUNCEXPR :funcid 401 :funcresulttype 25 :funcretset false :funcvariadic false :funcformat 1 :funccollid 100 :inputcollid 100 :args ({VAR :varno 1 :varattno 6 :vartype 1042 :vartypmod 5 :varcollid 100 :varlevelsup 0 :varnoold 1 :varoattno 6 :location 1181}) :location 1195}) :location 1174} {ARRAY :array_typeid 1009 :array_collid 100 :element_typeid 25 :elements ({CONST :consttype 25 :consttypmod -1 :constcollid 100 :constlen -1 :constbyval false :constisnull false :location 1216 :constvalue 5 [ 20 0 0 0 77 ]} {CONST :consttype 25 :consttypmod -1 :constcollid 100 :constlen -1 :constbyval false :constisnull false :location 1227 :constvalue 5 [ 20 0 0 0 83 ]}) :multidims false :location 1210}) :location 1203}</a></li>
<li class="chapter" data-level="13.103" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#consrc"><i class="fa fa-check"></i><b>13.103</b> consrc</a></li>
<li class="chapter" data-level="13.104" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#value-0"><i class="fa fa-check"></i><b>13.104</b> 1 (VALUE &gt;= 0)</a></li>
<li class="chapter" data-level="13.105" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#valuetext-any-arrayyescharacter-varying-nocharacter-varyingtext"><i class="fa fa-check"></i><b>13.105</b> 2 ((VALUE)::text = ANY ((ARRAY[‘YES’::character varying, ‘NO’::character varying])::text[]))</a></li>
<li class="chapter" data-level="13.106" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#birthdate-1930-01-01date-and-birthdate-now---18-yearsinterval"><i class="fa fa-check"></i><b>13.106</b> 3 ((birthdate &gt;= ‘1930-01-01’::date) AND (birthdate &lt;= (now() - ‘18 years’::interval)))</a></li>
<li class="chapter" data-level="13.107" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#uppergendertext-any-arraymtext-ftext"><i class="fa fa-check"></i><b>13.107</b> 4 (upper((gender)::text) = ANY (ARRAY[‘M’::text, ‘F’::text]))</a></li>
<li class="chapter" data-level="13.108" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#hiredate-1996-07-01date-and-hiredate-now-1-dayinterval"><i class="fa fa-check"></i><b>13.108</b> 5 ((hiredate &gt;= ‘1996-07-01’::date) AND (hiredate &lt;= (now() + ‘1 day’::interval)))</a></li>
<li class="chapter" data-level="13.109" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#uppermaritalstatustext-any-arraymtext-stext"><i class="fa fa-check"></i><b>13.109</b> 6 (upper((maritalstatus)::text) = ANY (ARRAY[‘M’::text, ‘S’::text]))</a></li>
<li class="chapter" data-level="13.110" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#condef"><i class="fa fa-check"></i><b>13.110</b> condef</a></li>
<li class="chapter" data-level="13.111" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#check-value-0"><i class="fa fa-check"></i><b>13.111</b> 1 CHECK (VALUE &gt;= 0)</a></li>
<li class="chapter" data-level="13.112" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#check-valuetext-any-arrayyescharacter-varying-nocharacter-varyingtext"><i class="fa fa-check"></i><b>13.112</b> 2 CHECK (VALUE::text = ANY (ARRAY[‘YES’::character varying, ‘NO’::character varying]::text[]))</a></li>
<li class="chapter" data-level="13.113" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#check-birthdate-1930-01-01date-and-birthdate-now---18-yearsinterval"><i class="fa fa-check"></i><b>13.113</b> 3 CHECK (birthdate &gt;= ‘1930-01-01’::date AND birthdate &lt;= (now() - ‘18 years’::interval))</a></li>
<li class="chapter" data-level="13.114" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#check-uppergendertext-any-arraymtext-ftext"><i class="fa fa-check"></i><b>13.114</b> 4 CHECK (upper(gender::text) = ANY (ARRAY[‘M’::text, ‘F’::text]))</a></li>
<li class="chapter" data-level="13.115" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#check-hiredate-1996-07-01date-and-hiredate-now-1-dayinterval"><i class="fa fa-check"></i><b>13.115</b> 5 CHECK (hiredate &gt;= ‘1996-07-01’::date AND hiredate &lt;= (now() + ‘1 day’::interval))</a></li>
<li class="chapter" data-level="13.116" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#check-uppermaritalstatustext-any-arraymtext-stext"><i class="fa fa-check"></i><b>13.116</b> 6 CHECK (upper(maritalstatus::text) = ANY (ARRAY[‘M’::text, ‘S’::text]))</a></li>
<li class="chapter" data-level="13.117" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#creating-your-own-data-dictionary"><i class="fa fa-check"></i><b>13.117</b> Creating your own data dictionary</a></li>
<li class="chapter" data-level="13.118" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#save-your-work"><i class="fa fa-check"></i><b>13.118</b> Save your work!</a></li>
<li class="chapter" data-level="13.119" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#columns_info_schema_info-columns_info_schema_table"><i class="fa fa-check"></i><b>13.119</b> [1] “columns_info_schema_info” “columns_info_schema_table”</a></li>
<li class="chapter" data-level="13.120" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#con-constraint_column_usage"><i class="fa fa-check"></i><b>13.120</b> [3] “con” “constraint_column_usage”</a></li>
<li class="chapter" data-level="13.121" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#cranex-key_column_usage"><i class="fa fa-check"></i><b>13.121</b> [5] “cranex” “key_column_usage”</a></li>
<li class="chapter" data-level="13.122" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#keys-public_tables"><i class="fa fa-check"></i><b>13.122</b> [7] “keys” “public_tables”</a></li>
<li class="chapter" data-level="13.123" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#referential_constraints-rs"><i class="fa fa-check"></i><b>13.123</b> [9] “referential_constraints” “rs”</a></li>
<li class="chapter" data-level="13.124" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#schema_list-table_constraints"><i class="fa fa-check"></i><b>13.124</b> [11] “schema_list” “table_constraints”</a></li>
<li class="chapter" data-level="13.125" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#table_info-table_info_schema_table"><i class="fa fa-check"></i><b>13.125</b> [13] “table_info” “table_info_schema_table”</a></li>
<li class="chapter" data-level="13.126" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#tables"><i class="fa fa-check"></i><b>13.126</b> [15] “tables”</a></li>
<li class="chapter" data-level="13.127" data-path="chapter-postgresql-metadata.html"><a href="chapter-postgresql-metadata.html#cleaning-up-1"><i class="fa fa-check"></i><b>13.127</b> Cleaning up</a></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html"><i class="fa fa-check"></i><b>A</b> Background and Basic Concepts</a><ul>
<li class="chapter" data-level="A.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#the-big-picture-r-and-the-docker-postgresql-playground-on-your-machine"><i class="fa fa-check"></i><b>A.1</b> The big picture: R and the Docker / PostgreSQL playground on your machine</a></li>
<li class="chapter" data-level="A.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#your-computer-and-its-operating-system"><i class="fa fa-check"></i><b>A.2</b> Your computer and its operating system</a></li>
<li class="chapter" data-level="A.3" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#r"><i class="fa fa-check"></i><b>A.3</b> R</a></li>
<li class="chapter" data-level="A.4" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#our-sqlpetr-package"><i class="fa fa-check"></i><b>A.4</b> Our <code>sqlpetr</code> package</a></li>
<li class="chapter" data-level="A.5" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#docker"><i class="fa fa-check"></i><b>A.5</b> Docker</a><ul>
<li class="chapter" data-level="A.5.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#virtual-machines-and-hypervisors"><i class="fa fa-check"></i><b>A.5.1</b> Virtual machines and hypervisors</a></li>
<li class="chapter" data-level="A.5.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#containers"><i class="fa fa-check"></i><b>A.5.2</b> Containers</a></li>
<li class="chapter" data-level="A.5.3" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#docker-itself"><i class="fa fa-check"></i><b>A.5.3</b> Docker itself</a></li>
<li class="chapter" data-level="A.5.4" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#docker-objects"><i class="fa fa-check"></i><b>A.5.4</b> Docker objects</a></li>
<li class="chapter" data-level="A.5.5" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#hosting-docker-on-windows-machines"><i class="fa fa-check"></i><b>A.5.5</b> Hosting Docker on Windows machines</a></li>
<li class="chapter" data-level="A.5.6" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#hosting-docker-on-macos-machines"><i class="fa fa-check"></i><b>A.5.6</b> Hosting Docker on macOS machines</a></li>
<li class="chapter" data-level="A.5.7" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#hosting-docker-on-unix-machines"><i class="fa fa-check"></i><b>A.5.7</b> Hosting Docker on UNIX machines</a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#normal-and-normalized-data"><i class="fa fa-check"></i><b>A.6</b> ‘Normal’ and ‘normalized’ data</a><ul>
<li class="chapter" data-level="A.6.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#tidy-data"><i class="fa fa-check"></i><b>A.6.1</b> Tidy data</a></li>
<li class="chapter" data-level="A.6.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#design-of-normal-data"><i class="fa fa-check"></i><b>A.6.2</b> Design of “normal data”</a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#sql-language"><i class="fa fa-check"></i><b>A.7</b> SQL Language</a><ul>
<li class="chapter" data-level="A.7.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#data-manipulation-langauge-dml"><i class="fa fa-check"></i><b>A.7.1</b> Data Manipulation Langauge (DML)</a></li>
<li class="chapter" data-level="A.7.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#data-definition-langauge-ddl"><i class="fa fa-check"></i><b>A.7.2</b> Data Definition Langauge (DDL)</a></li>
<li class="chapter" data-level="A.7.3" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#data-control-language-dcl"><i class="fa fa-check"></i><b>A.7.3</b> Data Control Language (DCL)</a></li>
<li class="chapter" data-level="A.7.4" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#transaction-control-language-tcl"><i class="fa fa-check"></i><b>A.7.4</b> Transaction Control Language (TCL)</a></li>
</ul></li>
<li class="chapter" data-level="A.8" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#enterprise-dbms"><i class="fa fa-check"></i><b>A.8</b> Enterprise DBMS</a><ul>
<li class="chapter" data-level="A.8.1" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#sql-databases"><i class="fa fa-check"></i><b>A.8.1</b> SQL databases</a></li>
<li class="chapter" data-level="A.8.2" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#data-mapping-between-r-vs-sql-data-types"><i class="fa fa-check"></i><b>A.8.2</b> Data mapping between R vs SQL data types</a></li>
<li class="chapter" data-level="A.8.3" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#postgresql-and-connection-parameters"><i class="fa fa-check"></i><b>A.8.3</b> PostgreSQL and connection parameters</a></li>
<li class="chapter" data-level="A.8.4" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#connecting-the-r-and-dbms-environments"><i class="fa fa-check"></i><b>A.8.4</b> Connecting the R and DBMS environments</a></li>
<li class="chapter" data-level="A.8.5" data-path="appendix-background-basic-concepts.html"><a href="appendix-background-basic-concepts.html#using-sqlite-to-simulate-an-enterprise-dbms"><i class="fa fa-check"></i><b>A.8.5</b> Using SQLite to simulate an enterprise DBMS</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="chapter-appendix-setup-instructions.html"><a href="chapter-appendix-setup-instructions.html"><i class="fa fa-check"></i><b>B</b> - Setup instructions</a><ul>
<li class="chapter" data-level="B.1" data-path="chapter-appendix-setup-instructions.html"><a href="chapter-appendix-setup-instructions.html#sandbox-prerequisites"><i class="fa fa-check"></i><b>B.1</b> Sandbox prerequisites</a></li>
<li class="chapter" data-level="B.2" data-path="chapter-appendix-setup-instructions.html"><a href="chapter-appendix-setup-instructions.html#r-rstudio-and-git"><i class="fa fa-check"></i><b>B.2</b> R, RStudio and Git</a></li>
<li class="chapter" data-level="B.3" data-path="chapter-appendix-setup-instructions.html"><a href="chapter-appendix-setup-instructions.html#install-docker"><i class="fa fa-check"></i><b>B.3</b> Install Docker</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="chapter-appendix-postgres-local-db-installation.html"><a href="chapter-appendix-postgres-local-db-installation.html"><i class="fa fa-check"></i><b>C</b> Appendix E - Install <code>adventureworks</code> on your own machine</a><ul>
<li class="chapter" data-level="C.1" data-path="chapter-appendix-postgres-local-db-installation.html"><a href="chapter-appendix-postgres-local-db-installation.html#overview-1"><i class="fa fa-check"></i><b>C.1</b> Overview</a><ul>
<li class="chapter" data-level="C.1.1" data-path="chapter-appendix-postgres-local-db-installation.html"><a href="chapter-appendix-postgres-local-db-installation.html#download-the-adventureworks-database"><i class="fa fa-check"></i><b>C.1.1</b> Download the <code>adventureworks</code> database</a></li>
<li class="chapter" data-level="C.1.2" data-path="chapter-appendix-postgres-local-db-installation.html"><a href="chapter-appendix-postgres-local-db-installation.html#restore-the-dvdrental-database-at-the-command-line"><i class="fa fa-check"></i><b>C.1.2</b> Restore the <code>dvdrental</code> database at the command line</a></li>
<li class="chapter" data-level="C.1.3" data-path="chapter-appendix-postgres-local-db-installation.html"><a href="chapter-appendix-postgres-local-db-installation.html#restore-the-adventureworks-database-using-pgadmin"><i class="fa fa-check"></i><b>C.1.3</b> Restore the <code>adventureworks</code> database using pgAdmin</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="chapter-appendix-postgres-local-db-installation.html"><a href="chapter-appendix-postgres-local-db-installation.html#resources"><i class="fa fa-check"></i><b>C.2</b> Resources</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html"><i class="fa fa-check"></i><b>D</b> Appendix B - Additional technical details for Windows users</a><ul>
<li class="chapter" data-level="D.1" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#hardware-requirements"><i class="fa fa-check"></i><b>D.1</b> Hardware requirements</a></li>
<li class="chapter" data-level="D.2" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#software-requirements"><i class="fa fa-check"></i><b>D.2</b> Software requirements</a><ul>
<li class="chapter" data-level="D.2.1" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#windows-7-8-8.1-and-windows-10-home-64-bit"><i class="fa fa-check"></i><b>D.2.1</b> Windows 7, 8, 8.1 and Windows 10 Home (64 bit)</a></li>
<li class="chapter" data-level="D.2.2" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#windows-10-pro"><i class="fa fa-check"></i><b>D.2.2</b> Windows 10 Pro</a></li>
</ul></li>
<li class="chapter" data-level="D.3" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#docker-for-windows-settings"><i class="fa fa-check"></i><b>D.3</b> Docker for Windows settings</a><ul>
<li class="chapter" data-level="D.3.1" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#shared-drives"><i class="fa fa-check"></i><b>D.3.1</b> Shared drives</a></li>
<li class="chapter" data-level="D.3.2" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#kubernetes"><i class="fa fa-check"></i><b>D.3.2</b> Kubernetes</a></li>
</ul></li>
<li class="chapter" data-level="D.4" data-path="chapter-windows-tech-details.html"><a href="chapter-windows-tech-details.html#git-github-and-line-endings"><i class="fa fa-check"></i><b>D.4</b> Git, GitHub and line endings</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html"><i class="fa fa-check"></i><b>E</b> Appendix C - PostgreSQL Authentication</a><ul>
<li class="chapter" data-level="E.1" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#introduction"><i class="fa fa-check"></i><b>E.1</b> Introduction</a></li>
<li class="chapter" data-level="E.2" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#password-authentication-on-the-postgresql-docker-image"><i class="fa fa-check"></i><b>E.2</b> Password authentication on the PostgreSQL Docker image</a></li>
<li class="chapter" data-level="E.3" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#adding-roles"><i class="fa fa-check"></i><b>E.3</b> Adding roles</a><ul>
<li class="chapter" data-level="E.3.1" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#setting-up-docker"><i class="fa fa-check"></i><b>E.3.1</b> Setting up Docker</a></li>
<li class="chapter" data-level="E.3.2" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#creating-a-new-container"><i class="fa fa-check"></i><b>E.3.2</b> Creating a new container</a></li>
<li class="chapter" data-level="E.3.3" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#adding-a-role"><i class="fa fa-check"></i><b>E.3.3</b> Adding a role</a></li>
<li class="chapter" data-level="E.3.4" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#did-it-work"><i class="fa fa-check"></i><b>E.3.4</b> Did it work?</a></li>
<li class="chapter" data-level="E.3.5" data-path="chapter-appendix-postresql-authentication.html"><a href="chapter-appendix-postresql-authentication.html#disconnect-and-remove-the-container"><i class="fa fa-check"></i><b>E.3.5</b> Disconnect and remove the container</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="F" data-path="chapter-appendix-dbi-index.html"><a href="chapter-appendix-dbi-index.html"><i class="fa fa-check"></i><b>F</b> DBI package functions - INDEX</a></li>
<li class="chapter" data-level="G" data-path="chapter-appendix-dplyr-to-postres-translation.html"><a href="chapter-appendix-dplyr-to-postres-translation.html"><i class="fa fa-check"></i><b>G</b> Appendix _ Dplyr to SQL translations</a><ul>
<li class="chapter" data-level="G.1" data-path="chapter-appendix-dplyr-to-postres-translation.html"><a href="chapter-appendix-dplyr-to-postres-translation.html#overview-2"><i class="fa fa-check"></i><b>G.1</b> Overview</a></li>
</ul></li>
<li class="chapter" data-level="H" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html"><i class="fa fa-check"></i><b>H</b> Appendix Additional resources</a><ul>
<li class="chapter" data-level="H.1" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#editing-this-book"><i class="fa fa-check"></i><b>H.1</b> Editing this book</a></li>
<li class="chapter" data-level="H.2" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#docker-alternatives"><i class="fa fa-check"></i><b>H.2</b> Docker alternatives</a></li>
<li class="chapter" data-level="H.3" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#docker-and-r"><i class="fa fa-check"></i><b>H.3</b> Docker and R</a></li>
<li class="chapter" data-level="H.4" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#documentation-for-docker-and-postgresql"><i class="fa fa-check"></i><b>H.4</b> Documentation for Docker and PostgreSQL</a></li>
<li class="chapter" data-level="H.5" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#sql-and-dplyr"><i class="fa fa-check"></i><b>H.5</b> SQL and dplyr</a></li>
<li class="chapter" data-level="H.6" data-path="chapter-appendix-additional-resources.html"><a href="chapter-appendix-additional-resources.html#more-resources"><i class="fa fa-check"></i><b>H.6</b> More Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Exploring Enterprise Databases with R: A Tidyverse Approach</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapter_leveraging-database-views" class="section level1">
<h1><span class="header-section-number">Chapter 12</span> Leveraging Database Views</h1>
<blockquote>
<p>This chapter demonstrates how to:</p>
<ul>
<li>Assess database views, understand their importance</li>
<li>Unpack a database view and check its assumptions</li>
<li>Create a database view either for personal use or for submittal to your enterprise DBA</li>
</ul>
</blockquote>
<div id="setup-our-standard-working-environment-1" class="section level2">
<h2><span class="header-section-number">12.1</span> Setup our standard working environment</h2>
<p>Use these libraries:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(DBI)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">library</span>(RPostgres)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="kw">library</span>(glue)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">require</span>(knitr)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">library</span>(dbplyr)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">library</span>(sqlpetr)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">library</span>(bookdown)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">library</span>(here)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">library</span>(lubridate)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">library</span>(skimr)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">library</span>(DiagrammeR)</a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="kw">library</span>(scales) <span class="co"># ggplot xy scales</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">theme_set</span>(<span class="kw">theme_light</span>())</a></code></pre></div>
<p>Connect to <code>adventureworks</code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">sp_docker_start</span>(<span class="st">&quot;adventureworks&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">Sys.sleep</span>(sleep_default)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">con &lt;-<span class="st"> </span><span class="kw">sp_get_postgres_connection</span>(</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">  <span class="dt">host =</span> <span class="st">&quot;localhost&quot;</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">  <span class="dt">port =</span> <span class="dv">5432</span>,</a>
<a class="sourceLine" id="cb2-6" data-line-number="6">  <span class="dt">user =</span> <span class="st">&quot;postgres&quot;</span>,</a>
<a class="sourceLine" id="cb2-7" data-line-number="7">  <span class="dt">password =</span> <span class="st">&quot;postgres&quot;</span>,</a>
<a class="sourceLine" id="cb2-8" data-line-number="8">  <span class="dt">dbname =</span> <span class="st">&quot;adventureworks&quot;</span>,</a>
<a class="sourceLine" id="cb2-9" data-line-number="9">  <span class="dt">seconds_to_test =</span> sleep_default, <span class="dt">connection_tab =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10">)</a></code></pre></div>
</div>
<div id="the-role-of-database-views" class="section level2">
<h2><span class="header-section-number">12.2</span> The role of database <code>views</code></h2>
<p>A database <code>view</code> is an SQL query that is stored in the database. Most <code>views</code> are used for data retrieval, since they usually denormalize the tables involved. Because they are standardized and well-understood, they can save you a lot of work.</p>
<div id="why-database-views-are-useful" class="section level3">
<h3><span class="header-section-number">12.2.1</span> Why database <code>views</code> are useful</h3>
<p>Database <code>views</code> are useful for many reasons.</p>
<ul>
<li><strong>Authoritative</strong>: database <code>views</code> are typically written by the business application vendor or DBA, so they contain authoritative knowledge about the structure and intended use of the database.</li>
<li><strong>Performance</strong>: <code>views</code> are designed to gather data in an efficient way, using all the indexes in an efficient sequence and doing as much work on the database server as possible.</li>
<li><strong>Abstraction</strong>: <code>views</code> are abstractions or simplifications of complex queries that provide customary (useful) aggregations. Common examples would be monthly totals or aggregation of activity tied to one individual.</li>
<li><strong>Reuse</strong>: a <code>view</code> puts commonly used code in one place where it can be used for many purposes by many people. If there is a change or a problem found in a <code>view</code>, it only needs to be fixed in one place, rather than having to change many places downstream.</li>
<li><strong>Security</strong>: a view can give selective access to someone who does not have access to underlying tables or columns.</li>
<li><strong>Provenance</strong>: <code>views</code> standardize data provenance. For example, the <code>AdventureWorks</code> database all of them are named in a consistent way that suggests the underlying tables that they query. And they all start with a <strong>v</strong>.</li>
</ul>
</div>
<div id="rely-on-and-be-critical-of-views" class="section level3">
<h3><span class="header-section-number">12.2.2</span> Rely on <strong>and</strong> be critical of <code>views</code></h3>
<p>Because they represent a conventional view of the database, a <code>view</code> may seem quite boring; remember why they are very important. Just because they are conventional and authorized, they may still need verification or auditing when used for a purpose other than the original intent. They can guide you toward what you need from the database but they could also mislead because they are easy to use and available. People may forget why a specific view exists and who is using it. Therefore any given view might be a forgotten vestige or part of an production data pipeline or might a priceless nugget of insight.</p>
</div>
<div id="how-to-unpack-and-inspect-a-view" class="section level3">
<h3><span class="header-section-number">12.2.3</span> How to unpack and inspect a <code>view</code></h3>
<p>From a retrieval perspective a database <code>view</code> is just like any other table. Using a view to retrieve data from the database will be completely standard across all flavors of SQL. (To find out what a view does behind the scenes requires that you use functions that are <strong>not</strong> standard.)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">v_salesperson_sales_by_fiscal_years_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;sales&quot;</span>,<span class="st">&quot;vsalespersonsalesbyfiscalyearsdata&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw">collect</span>()</a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="kw">str</span>(v_salesperson_sales_by_fiscal_years_data)</a></code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    48 obs. of  6 variables:
##  $ salespersonid : int  275 275 275 275 276 276 276 276 277 277 ...
##  $ fullname      : chr  &quot;Michael G Blythe&quot; &quot;Michael G Blythe&quot; &quot;Michael G Blythe&quot; &quot;Michael G Blythe&quot; ...
##  $ jobtitle      : chr  &quot;Sales Representative&quot; &quot;Sales Representative&quot; &quot;Sales Representative&quot; &quot;Sales Representative&quot; ...
##  $ salesterritory: chr  &quot;Northeast&quot; &quot;Northeast&quot; &quot;Northeast&quot; &quot;Northeast&quot; ...
##  $ salestotal    : num  63763 2399593 3765459 3065088 5476 ...
##  $ fiscalyear    : num  2011 2012 2013 2014 2011 ...</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">skim</span>(<span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;sales&quot;</span>,<span class="st">&quot;vsalespersonsalesbyfiscalyearsdata&quot;</span>)))</a></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-1">Table 12.1: </span>Data summary</caption>
<tbody>
<tr class="odd">
<td align="left">Name</td>
<td align="left">tbl(con, in_schema(&quot;sales…</td>
</tr>
<tr class="even">
<td align="left">Number of rows</td>
<td align="left">48</td>
</tr>
<tr class="odd">
<td align="left">Number of columns</td>
<td align="left">6</td>
</tr>
<tr class="even">
<td align="left">_______________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Column type frequency:</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">character</td>
<td align="left">3</td>
</tr>
<tr class="odd">
<td align="left">numeric</td>
<td align="left">3</td>
</tr>
<tr class="even">
<td align="left">________________________</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Group variables</td>
<td align="left">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">min</th>
<th align="right">max</th>
<th align="right">empty</th>
<th align="right">n_unique</th>
<th align="right">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">fullname</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">9</td>
<td align="right">26</td>
<td align="right">0</td>
<td align="right">14</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">jobtitle</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">20</td>
<td align="right">20</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">salesterritory</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">14</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">skim_variable</th>
<th align="right">n_missing</th>
<th align="right">complete_rate</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">p0</th>
<th align="right">p25</th>
<th align="right">p50</th>
<th align="right">p75</th>
<th align="right">p100</th>
<th align="left">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">salespersonid</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">281.19</td>
<td align="right">4.57</td>
<td align="right">275.00</td>
<td align="right">277.75</td>
<td align="right">280.50</td>
<td align="right">283.25</td>
<td align="right">290</td>
<td align="left">▇▆▅▁▃</td>
</tr>
<tr class="even">
<td align="left">salestotal</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1635214.51</td>
<td align="right">1243833.87</td>
<td align="right">5475.95</td>
<td align="right">533827.70</td>
<td align="right">1371169.72</td>
<td align="right">2409498.88</td>
<td align="right">4188307</td>
<td align="left">▇▇▆▃▃</td>
</tr>
<tr class="odd">
<td align="left">fiscalyear</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">2012.69</td>
<td align="right">1.09</td>
<td align="right">2011.00</td>
<td align="right">2012.00</td>
<td align="right">2013.00</td>
<td align="right">2014.00</td>
<td align="right">2014</td>
<td align="left">▅▆▁▇▇</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;sales&quot;</span>,<span class="st">&quot;vsalespersonsalesbyfiscalyearsdata&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(salespersonid <span class="op">==</span><span class="st"> </span><span class="dv">275</span>)</a></code></pre></div>
<pre><code>## # Source:   lazy query [?? x 6]
## # Database: postgres [postgres@localhost:5432/adventureworks]
##   salespersonid fullname     jobtitle       salesterritory salestotal fiscalyear
##           &lt;int&gt; &lt;chr&gt;        &lt;chr&gt;          &lt;chr&gt;               &lt;dbl&gt;      &lt;dbl&gt;
## 1           275 Michael G B… Sales Represe… Northeast          63763.       2011
## 2           275 Michael G B… Sales Represe… Northeast        2399593.       2012
## 3           275 Michael G B… Sales Represe… Northeast        3765459.       2013
## 4           275 Michael G B… Sales Represe… Northeast        3065088.       2014</code></pre>
<p>Local idioms for looking at a view itself will vary. Here is the code to retrieve a PostgreSQL view (using the <code>pg_get_viewdef</code> function):</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">view_definition &lt;-<span class="st"> </span><span class="kw">dbGetQuery</span>(con, <span class="st">&quot;select </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="st">                   pg_get_viewdef(&#39;sales.vsalespersonsalesbyfiscalyearsdata&#39;, </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="st">                   true)&quot;</span>)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="kw">str</span>(view_definition)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1 obs. of  1 variable:
##  $ pg_get_viewdef: chr &quot; SELECT granular.salespersonid,\n    granular.fullname,\n    granular.jobtitle,\n    granular.salesterritory,\n&quot;| __truncated__</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">cat</span>(<span class="kw">str_replace_all</span>(view_definition<span class="op">$</span>pg_get_viewdef, <span class="st">&quot;</span><span class="ch">\\\\\\\\</span><span class="st">n&quot;</span>, <span class="st">&quot;</span><span class="ch">\\\\</span><span class="st">n&quot;</span>)) </a></code></pre></div>
<pre><code>##  SELECT granular.salespersonid,
##     granular.fullname,
##     granular.jobtitle,
##     granular.salesterritory,
##     sum(granular.subtotal) AS salestotal,
##     granular.fiscalyear
##    FROM ( SELECT soh.salespersonid,
##             ((p.firstname::text || &#39; &#39;::text) || COALESCE(p.middlename::text || &#39; &#39;::text, &#39;&#39;::text)) || p.lastname::text AS fullname,
##             e.jobtitle,
##             st.name AS salesterritory,
##             soh.subtotal,
##             date_part(&#39;year&#39;::text, soh.orderdate + &#39;6 mons&#39;::interval) AS fiscalyear
##            FROM sales.salesperson sp
##              JOIN sales.salesorderheader soh ON sp.businessentityid = soh.salespersonid
##              JOIN sales.salesterritory st ON sp.territoryid = st.territoryid
##              JOIN humanresources.employee e ON soh.salespersonid = e.businessentityid
##              JOIN person.person p ON p.businessentityid = sp.businessentityid) granular
##   GROUP BY granular.salespersonid, granular.fullname, granular.jobtitle, granular.salesterritory, granular.fiscalyear;</code></pre>
<p>Even if you don’t intend to become fluent in SQL, it’s useful to read as much of it as possible.</p>
<p>To understand this query, you really need to have the Entity Relationship Diagram (ERD) handy. The ERD for <code>AdventureWorks</code> is <a href="https://i.stack.imgur.com/LMu4W.gif">here</a></p>
</div>
</div>
<div id="reproduce-the-view-with-dplyr" class="section level2">
<h2><span class="header-section-number">12.3</span> Reproduce the <code>view</code> with dplyr</h2>
<p>Save and study the SQL.</p>
<p>It can be helpful to actually mark up the ERD to identify the specific tables that are involved in the view you are going to reproduce.
<img src="screenshots/AW-2008-OLTP-ERD.gif" /></p>
<p>Define each table that is involved and identify the columns that will be needed from that table. The tables that are involved are:</p>
<ol style="list-style-type: decimal">
<li>employee</li>
<li>person</li>
<li>sales_person</li>
<li>sales_order_header</li>
<li>sales_territory</li>
</ol>
<p>Select the columns and do any necessary changes or renaming. In this case we follow the convention that any column that we change or create on the fly uses a snake case naming con vention.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">sales_order_header &lt;-<span class="st"> </span><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;sales&quot;</span>, <span class="st">&quot;salesorderheader&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="st">  </span><span class="co"># Because we&#39;re lazy, we will keep both a crude `year` column and `orderdate` for later use</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sales_order_year =</span> <span class="kw">year</span>(orderdate)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="st">  </span><span class="kw">select</span>(sales_order_year, salespersonid, subtotal, orderdate) </a>
<a class="sourceLine" id="cb12-5" data-line-number="5"></a>
<a class="sourceLine" id="cb12-6" data-line-number="6">sales_territory &lt;-<span class="st"> </span><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;sales&quot;</span>, <span class="st">&quot;salesterritory&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="st">    </span><span class="kw">select</span>(territoryid, <span class="dt">territory_name =</span> name) </a>
<a class="sourceLine" id="cb12-8" data-line-number="8">  </a>
<a class="sourceLine" id="cb12-9" data-line-number="9">sales_person &lt;-<span class="st"> </span><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;sales&quot;</span>, <span class="st">&quot;salesperson&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="st">  </span><span class="kw">select</span>(businessentityid, territoryid) </a>
<a class="sourceLine" id="cb12-11" data-line-number="11"></a>
<a class="sourceLine" id="cb12-12" data-line-number="12">employee &lt;-<span class="st"> </span><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;humanresources&quot;</span>, <span class="st">&quot;employee&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-13" data-line-number="13"><span class="st">  </span><span class="kw">select</span>(businessentityid, jobtitle)</a>
<a class="sourceLine" id="cb12-14" data-line-number="14"></a>
<a class="sourceLine" id="cb12-15" data-line-number="15">person &lt;-<span class="st"> </span><span class="kw">tbl</span>(con, <span class="kw">in_schema</span>(<span class="st">&quot;person&quot;</span>, <span class="st">&quot;person&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-16" data-line-number="16"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">full_name =</span> <span class="kw">paste</span>(firstname, middlename, lastname)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-17" data-line-number="17"><span class="st">  </span><span class="kw">select</span>(businessentityid, full_name)</a></code></pre></div>
<p>Double check on the names that are defined in each <code>tbl</code> object. First define a function to show the names of columns you will retrieve.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">getnames &lt;-<span class="st"> </span><span class="cf">function</span>(table) {</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">  {table} <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">collect</span>(<span class="dt">n =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">names</span>()</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">}</a></code></pre></div>
<p>Verify the names selected:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">getnames</span>(employee)</a></code></pre></div>
<pre><code>## [1] &quot;businessentityid&quot; &quot;jobtitle&quot;</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">getnames</span>(person)</a></code></pre></div>
<pre><code>## [1] &quot;businessentityid&quot; &quot;full_name&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="kw">getnames</span>(sales_person)</a></code></pre></div>
<pre><code>## [1] &quot;businessentityid&quot; &quot;territoryid&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw">getnames</span>(sales_order_header)</a></code></pre></div>
<pre><code>## [1] &quot;sales_order_year&quot; &quot;salespersonid&quot;    &quot;subtotal&quot;         &quot;orderdate&quot;</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="kw">getnames</span>(sales_territory)</a></code></pre></div>
<pre><code>## [1] &quot;territoryid&quot;    &quot;territory_name&quot;</code></pre>
<p>Join all of the data pertaining to a person.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">salesperson_info &lt;-<span class="st"> </span>sales_person <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(employee) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3"><span class="st">  </span><span class="kw">left_join</span>(person) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4"><span class="st">  </span><span class="kw">left_join</span>(sales_territory) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5"><span class="st">  </span><span class="kw">collect</span>()</a></code></pre></div>
<pre><code>## Joining, by = &quot;businessentityid&quot;Joining, by = &quot;businessentityid&quot;Joining, by =
## &quot;territoryid&quot;</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw">str</span>(salesperson_info)</a></code></pre></div>
<pre><code>## Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    17 obs. of  5 variables:
##  $ businessentityid: int  274 275 276 277 278 279 280 281 282 283 ...
##  $ territoryid     : int  NA 2 4 3 6 5 1 4 6 1 ...
##  $ jobtitle        : chr  &quot;North American Sales Manager&quot; &quot;Sales Representative&quot; &quot;Sales Representative&quot; &quot;Sales Representative&quot; ...
##  $ full_name       : chr  &quot;Stephen Y Jiang&quot; &quot;Michael G Blythe&quot; &quot;Linda C Mitchell&quot; &quot;Jillian Carson&quot; ...
##  $ territory_name  : chr  NA &quot;Northeast&quot; &quot;Southwest&quot; &quot;Central&quot; ...</code></pre>
<p>Do a crude version with <code>sales_order_year</code>. All of the work can be done on the database server.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">sales_data_year &lt;-<span class="st"> </span>sales_person <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(sales_order_header, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;businessentityid&quot;</span> =<span class="st"> &quot;salespersonid&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-3" data-line-number="3"><span class="st">  </span><span class="kw">group_by</span>(businessentityid, sales_order_year) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-4" data-line-number="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">sales_total =</span> <span class="kw">sum</span>(subtotal, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-5" data-line-number="5"><span class="st">  </span><span class="kw">collect</span>()</a></code></pre></div>
<p>Lubridate makes it very easy to convert <code>orderdate</code> to <code>fiscal_year</code>. Doing that conversion interleaving dplyr and <strong>ANSI-STANDARD</strong> SQL is harder. Too lazy! Therefore we just pull the data from the server after the <code>left_join</code> and do the rest of the job on the R side.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">sales_data_fiscal_year &lt;-<span class="st"> </span>sales_person <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(sales_order_header, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;businessentityid&quot;</span> =<span class="st"> &quot;salespersonid&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-3" data-line-number="3"><span class="st">  </span><span class="kw">collect</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">fiscal_year =</span> <span class="kw">year</span>(orderdate <span class="op">%m+%</span><span class="st"> </span><span class="kw">months</span>(<span class="dv">6</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5"><span class="st">  </span><span class="kw">group_by</span>(businessentityid, fiscal_year) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">sales_total =</span> <span class="kw">sum</span>(subtotal, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-7" data-line-number="7"><span class="st">  </span><span class="kw">ungroup</span>()</a></code></pre></div>
<p>Put the two parts together: <code>sales_data_fiscal_year</code> and <code>person_info</code> to yeild the final query.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">salesperson_sales_by_fiscal_years_dplyr &lt;-<span class="st"> </span>sales_data_fiscal_year <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="st">  </span><span class="kw">left_join</span>(salesperson_info) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(territoryid))</a></code></pre></div>
<pre><code>## Joining, by = &quot;businessentityid&quot;</code></pre>
<p>Notice that we’re droping the Sales Managers – who don’t have a <code>territoryid</code>.</p>
<div id="compare-the-two-versions" class="section level3">
<h3><span class="header-section-number">12.3.1</span> Compare the two versions</h3>
<p>Use <code>pivot_wider</code> to make it easier to compare the native view to our dplyr version.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">salesperson_sales_by_fiscal_years_dplyr <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>jobtitle, <span class="op">-</span><span class="st"> </span>territoryid) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> fiscal_year, <span class="dt">values_from =</span> sales_total)</a></code></pre></div>
<pre><code>## # A tibble: 14 x 7
##    businessentityid full_name      territory_name  `2011`   `2012` `2013` `2014`
##               &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1              275 Michael G Bly… Northeast       63763. 2399593. 3.77e6 3.07e6
##  2              276 Linda C Mitch… Southwest        5476. 3013884. 4.06e6 3.28e6
##  3              277 Jillian Carson Central         46696. 3496244. 3.94e6 2.58e6
##  4              278 Garrett R Var… Canada           9109. 1254087. 1.18e6 1.17e6
##  5              279 Tsvi Michael … Southeast      104419. 3037175. 2.16e6 1.87e6
##  6              280 Pamela O Ansm… Northwest       24433. 1533076. 5.88e5 1.18e6
##  7              281 Shu K Ito      Southwest       59708. 1953001. 2.44e6 1.98e6
##  8              282 José Edvaldo … Canada         106252. 2171995. 1.39e6 2.26e6
##  9              283 David R Campb… Northwest       69473. 1291905. 1.15e6 1.22e6
## 10              284 Tete A Mensa-… Northwest          NA       NA  9.59e5 1.35e6
## 11              286 Lynn N Tsofli… Australia          NA       NA  1.84e5 1.24e6
## 12              288 Rachel B Vald… Germany            NA       NA  3.72e5 1.46e6
## 13              289 Jae B Pak      United Kingdom     NA   963345. 4.19e6 3.35e6
## 14              290 Ranjit R Vark… France             NA   360246. 1.77e6 2.38e6</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">v_salesperson_sales_by_fiscal_years_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>jobtitle) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> fiscalyear, <span class="dt">values_from =</span> salestotal)</a></code></pre></div>
<pre><code>## # A tibble: 14 x 7
##    salespersonid fullname         salesterritory  `2011`   `2012`  `2013` `2014`
##            &lt;int&gt; &lt;chr&gt;            &lt;chr&gt;            &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
##  1           275 Michael G Blythe Northeast       63763. 2399593.  3.77e6 3.07e6
##  2           276 Linda C Mitchell Southwest        5476. 3013884.  4.06e6 3.28e6
##  3           277 Jillian Carson   Central         46696. 3496244.  3.94e6 2.58e6
##  4           278 Garrett R Vargas Canada           9109. 1254087.  1.18e6 1.17e6
##  5           279 Tsvi Michael Re… Southeast      104419. 3037175.  2.16e6 1.87e6
##  6           280 Pamela O Ansman… Northwest       24433. 1533076.  5.88e5 1.18e6
##  7           281 Shu K Ito        Southwest       59708. 1953001.  2.44e6 1.98e6
##  8           282 José Edvaldo Sa… Canada         106252. 2171995.  1.39e6 2.26e6
##  9           283 David R Campbell Northwest       69473. 1291905.  1.15e6 1.22e6
## 10           284 Tete A Mensa-An… Northwest          NA       NA   9.59e5 1.35e6
## 11           286 Lynn N Tsoflias  Australia          NA       NA   1.84e5 1.24e6
## 12           288 Rachel B Valdez  Germany            NA       NA   3.72e5 1.46e6
## 13           289 Jae B Pak        United Kingdom     NA   963345.  4.19e6 3.35e6
## 14           290 Ranjit R Varkey… France             NA   360246.  1.77e6 2.38e6</code></pre>
<p>The column names don’t match up, partly because we are using snake case convention for derived elements.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">names</span>(salesperson_sales_by_fiscal_years_dplyr) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sort</span>()</a></code></pre></div>
<pre><code>## [1] &quot;businessentityid&quot; &quot;fiscal_year&quot;      &quot;full_name&quot;        &quot;jobtitle&quot;        
## [5] &quot;sales_total&quot;      &quot;territory_name&quot;   &quot;territoryid&quot;</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">names</span>(v_salesperson_sales_by_fiscal_years_data) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sort</span>()</a></code></pre></div>
<pre><code>## [1] &quot;fiscalyear&quot;     &quot;fullname&quot;       &quot;jobtitle&quot;       &quot;salespersonid&quot; 
## [5] &quot;salesterritory&quot; &quot;salestotal&quot;</code></pre>
<p>Why 3 sales folks in vsalesperson don’t show up in 2014 vsalespersonsalesbyfiscalyearsdata</p>
<p>Different environments / SQL dialects</p>
</div>
<div id="revise-the-view" class="section level3">
<h3><span class="header-section-number">12.3.2</span> Revise the view</h3>
<ul>
<li>What about by month? This could be motivation for creating a new view that does aggregation in the database, rather than in R.</li>
<li>See SQL code for ‘vsalespersonsalesbyfiscalyearsdata’. Consider:</li>
<li>Modifying that to include quantity of sales.</li>
<li>Modifying that to include monthly totals, in addition to the yearly totals that it already has.</li>
<li>Why are 3 of the sales people from ‘vsalesperson’ missing in ‘vsalespersonsalesbyfiscalyearsdata’?
<ul>
<li>Amy Alberts</li>
<li>Stephen Jiang</li>
<li>Syed Abbas</li>
</ul></li>
<li>Making the change may not be your prerogative, but it’s your responsibility to propose any reasonable changes to those who have the authority to make the make the change.</li>
</ul>
</div>
</div>
<div id="save-a-view-in-the-database" class="section level2">
<h2><span class="header-section-number">12.4</span> Save a <code>view</code> in the database</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapter-lazy-evaluation-and-timing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapter-postgresql-metadata.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smithjd/sql-pet/edit/master/098-leveraging-database-views.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
