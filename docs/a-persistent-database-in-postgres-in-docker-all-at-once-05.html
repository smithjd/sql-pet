<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R, Databases and Docker</title>
  <meta name="description" content="A collection of tutorials for integrating R with databases using Docker">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R, Databases and Docker" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A collection of tutorials for integrating R with databases using Docker" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R, Databases and Docker" />
  
  <meta name="twitter:description" content="A collection of tutorials for integrating R with databases using Docker" />
  

<meta name="author" content="Dipti Muni, Ian Frantz, John David Smith, Mary Anne Thygesen, M. Edward (Ed) Borasky, Scott Case, and Sophie Yang">


<meta name="date" content="2018-09-28">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="docker-postgres-and-r-04.html">
<link rel="next" href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R, Databases and Docker</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#using-r-to-query-a-dbms-in-your-organization"><i class="fa fa-check"></i><b>1.1</b> Using R to query a DBMS in your organization</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#dockers-role"><i class="fa fa-check"></i><b>1.2</b> Docker’s role</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#docker-and-r-on-your-machine"><i class="fa fa-check"></i><b>1.3</b> Docker and R on your machine</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#who-are-we"><i class="fa fa-check"></i><b>1.4</b> Who are we?</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.5</b> Prerequisites</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#install-docker"><i class="fa fa-check"></i><b>1.6</b> Install Docker</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#download-the-repo"><i class="fa fa-check"></i><b>1.7</b> Download the repo</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="docker-hosting-for-windows-02.html"><a href="docker-hosting-for-windows-02.html"><i class="fa fa-check"></i><b>2</b> Docker Hosting for Windows (02)</a><ul>
<li class="chapter" data-level="2.1" data-path="docker-hosting-for-windows-02.html"><a href="docker-hosting-for-windows-02.html#hardware-requirements"><i class="fa fa-check"></i><b>2.1</b> Hardware requirements</a></li>
<li class="chapter" data-level="2.2" data-path="docker-hosting-for-windows-02.html"><a href="docker-hosting-for-windows-02.html#software-requirements"><i class="fa fa-check"></i><b>2.2</b> Software requirements</a><ul>
<li class="chapter" data-level="2.2.1" data-path="docker-hosting-for-windows-02.html"><a href="docker-hosting-for-windows-02.html#windows-7-8-8.1-and-windows-10-home-64-bit"><i class="fa fa-check"></i><b>2.2.1</b> Windows 7, 8, 8.1 and Windows 10 Home (64 bit)</a></li>
<li class="chapter" data-level="2.2.2" data-path="docker-hosting-for-windows-02.html"><a href="docker-hosting-for-windows-02.html#windows-10-pro"><i class="fa fa-check"></i><b>2.2.2</b> Windows 10 Pro</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="docker-hosting-for-windows-02.html"><a href="docker-hosting-for-windows-02.html#docker-for-windows-settings"><i class="fa fa-check"></i><b>2.3</b> Docker for Windows settings</a><ul>
<li class="chapter" data-level="2.3.1" data-path="docker-hosting-for-windows-02.html"><a href="docker-hosting-for-windows-02.html#shared-drives"><i class="fa fa-check"></i><b>2.3.1</b> Shared drives</a></li>
<li class="chapter" data-level="2.3.2" data-path="docker-hosting-for-windows-02.html"><a href="docker-hosting-for-windows-02.html#kubernetes"><i class="fa fa-check"></i><b>2.3.2</b> Kubernetes</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="docker-hosting-for-windows-02.html"><a href="docker-hosting-for-windows-02.html#git-github-and-line-endings"><i class="fa fa-check"></i><b>2.4</b> Git, GitHub and line endings</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="learning-goals-and-use-cases.html"><a href="learning-goals-and-use-cases.html"><i class="fa fa-check"></i><b>3</b> Learning Goals and Use Cases</a><ul>
<li class="chapter" data-level="3.1" data-path="learning-goals-and-use-cases.html"><a href="learning-goals-and-use-cases.html#context-why-integrate-r-with-databases-using-docker-03"><i class="fa fa-check"></i><b>3.1</b> Context: Why integrate R with databases using Docker? (03)</a></li>
<li class="chapter" data-level="3.2" data-path="learning-goals-and-use-cases.html"><a href="learning-goals-and-use-cases.html#learning-goals"><i class="fa fa-check"></i><b>3.2</b> Learning Goals</a></li>
<li class="chapter" data-level="3.3" data-path="learning-goals-and-use-cases.html"><a href="learning-goals-and-use-cases.html#use-cases"><i class="fa fa-check"></i><b>3.3</b> Use cases</a></li>
<li class="chapter" data-level="3.4" data-path="learning-goals-and-use-cases.html"><a href="learning-goals-and-use-cases.html#environment"><i class="fa fa-check"></i><b>3.4</b> Environment</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="docker-postgres-and-r-04.html"><a href="docker-postgres-and-r-04.html"><i class="fa fa-check"></i><b>4</b> Docker, Postgres, and R (04)</a><ul>
<li class="chapter" data-level="4.1" data-path="docker-postgres-and-r-04.html"><a href="docker-postgres-and-r-04.html#verify-that-docker-running"><i class="fa fa-check"></i><b>4.1</b> Verify that Docker running</a></li>
<li class="chapter" data-level="4.2" data-path="docker-postgres-and-r-04.html"><a href="docker-postgres-and-r-04.html#clean-up-if-appropriate"><i class="fa fa-check"></i><b>4.2</b> Clean up if appropriate</a></li>
<li class="chapter" data-level="4.3" data-path="docker-postgres-and-r-04.html"><a href="docker-postgres-and-r-04.html#connect-read-and-write-to-postgres-from-r"><i class="fa fa-check"></i><b>4.3</b> Connect, read and write to Postgres from R</a><ul>
<li class="chapter" data-level="4.3.1" data-path="docker-postgres-and-r-04.html"><a href="docker-postgres-and-r-04.html#pause-for-some-security-considerations"><i class="fa fa-check"></i><b>4.3.1</b> Pause for some security considerations</a></li>
<li class="chapter" data-level="4.3.2" data-path="docker-postgres-and-r-04.html"><a href="docker-postgres-and-r-04.html#alternative-put-the-database-password-in-an-environment-file"><i class="fa fa-check"></i><b>4.3.2</b> Alternative: put the database password in an environment file</a></li>
<li class="chapter" data-level="4.3.3" data-path="docker-postgres-and-r-04.html"><a href="docker-postgres-and-r-04.html#interact-with-postgres"><i class="fa fa-check"></i><b>4.3.3</b> Interact with Postgres</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="docker-postgres-and-r-04.html"><a href="docker-postgres-and-r-04.html#clean-up"><i class="fa fa-check"></i><b>4.4</b> Clean up</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><i class="fa fa-check"></i><b>5</b> A persistent database in Postgres in Docker - all at once (05)</a><ul>
<li class="chapter" data-level="5.1" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html#overview"><i class="fa fa-check"></i><b>5.1</b> Overview</a></li>
<li class="chapter" data-level="5.2" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html#first-verify-that-docker-is-up-and-running"><i class="fa fa-check"></i><b>5.2</b> First, verify that Docker is up and running:</a></li>
<li class="chapter" data-level="5.3" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html#clean-up-if-appropriate-1"><i class="fa fa-check"></i><b>5.3</b> Clean up if appropriate</a></li>
<li class="chapter" data-level="5.4" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html#build-the-docker-image"><i class="fa fa-check"></i><b>5.4</b> Build the Docker Image</a></li>
<li class="chapter" data-level="5.5" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html#run-the-docker-image"><i class="fa fa-check"></i><b>5.5</b> Run the Docker Image</a></li>
<li class="chapter" data-level="5.6" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html#connect-to-postgres-with-r"><i class="fa fa-check"></i><b>5.6</b> Connect to Postgres with R</a></li>
<li class="chapter" data-level="5.7" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html#stop-and-start-to-demonstrate-persistence"><i class="fa fa-check"></i><b>5.7</b> Stop and start to demonstrate persistence</a></li>
<li class="chapter" data-level="5.8" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html#cleaning-up"><i class="fa fa-check"></i><b>5.8</b> Cleaning up</a></li>
<li class="chapter" data-level="5.9" data-path="a-persistent-database-in-postgres-in-docker-all-at-once-05.html"><a href="a-persistent-database-in-postgres-in-docker-all-at-once-05.html#using-the-sql-pet-container-in-the-rest-of-the-book"><i class="fa fa-check"></i><b>5.9</b> Using the <code>sql-pet</code> container in the rest of the book</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="a-persistent-database-in-postgres-in-docker-piecemeal-06.html"><a href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html"><i class="fa fa-check"></i><b>6</b> A persistent database in Postgres in Docker - piecemeal (06)</a><ul>
<li class="chapter" data-level="6.1" data-path="a-persistent-database-in-postgres-in-docker-piecemeal-06.html"><a href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html#overview-1"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="a-persistent-database-in-postgres-in-docker-piecemeal-06.html"><a href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html#retrieve-the-backup-file"><i class="fa fa-check"></i><b>6.2</b> Retrieve the backup file</a></li>
<li class="chapter" data-level="6.3" data-path="a-persistent-database-in-postgres-in-docker-piecemeal-06.html"><a href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html#now-verify-that-docker-is-up-and-running"><i class="fa fa-check"></i><b>6.3</b> Now, verify that Docker is up and running:</a></li>
<li class="chapter" data-level="6.4" data-path="a-persistent-database-in-postgres-in-docker-piecemeal-06.html"><a href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html#build-the-docker-image-1"><i class="fa fa-check"></i><b>6.4</b> Build the Docker Image</a></li>
<li class="chapter" data-level="6.5" data-path="a-persistent-database-in-postgres-in-docker-piecemeal-06.html"><a href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html#stop-and-start-to-demonstrate-persistence-1"><i class="fa fa-check"></i><b>6.5</b> Stop and start to demonstrate persistence</a></li>
<li class="chapter" data-level="6.6" data-path="a-persistent-database-in-postgres-in-docker-piecemeal-06.html"><a href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html#cleaning-up-1"><i class="fa fa-check"></i><b>6.6</b> Cleaning up</a></li>
<li class="chapter" data-level="6.7" data-path="a-persistent-database-in-postgres-in-docker-piecemeal-06.html"><a href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html#using-the-sql-pet-container-in-the-rest-of-the-book-1"><i class="fa fa-check"></i><b>6.7</b> Using the <code>sql-pet</code> container in the rest of the book</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="introduction-to-interacting-with-postgres-from-r-10.html"><a href="introduction-to-interacting-with-postgres-from-r-10.html"><i class="fa fa-check"></i><b>7</b> Introduction to interacting with Postgres from R (10)</a><ul>
<li class="chapter" data-level="7.1" data-path="introduction-to-interacting-with-postgres-from-r-10.html"><a href="introduction-to-interacting-with-postgres-from-r-10.html#basics"><i class="fa fa-check"></i><b>7.1</b> Basics</a></li>
<li class="chapter" data-level="7.2" data-path="introduction-to-interacting-with-postgres-from-r-10.html"><a href="introduction-to-interacting-with-postgres-from-r-10.html#ask-yourself-about-what-you-are-aiming-for"><i class="fa fa-check"></i><b>7.2</b> Ask yourself about what you are aiming for?</a></li>
<li class="chapter" data-level="7.3" data-path="introduction-to-interacting-with-postgres-from-r-10.html"><a href="introduction-to-interacting-with-postgres-from-r-10.html#get-some-basic-information-about-your-database"><i class="fa fa-check"></i><b>7.3</b> Get some basic information about your database</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html"><i class="fa fa-check"></i><b>8</b> Real work with real data (11)</a><ul>
<li class="chapter" data-level="8.1" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#some-extra-handy-libraries"><i class="fa fa-check"></i><b>8.1</b> Some extra handy libraries</a></li>
<li class="chapter" data-level="8.2" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#basic-investigation"><i class="fa fa-check"></i><b>8.2</b> Basic investigation</a></li>
<li class="chapter" data-level="8.3" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#using-dplyr"><i class="fa fa-check"></i><b>8.3</b> Using Dplyr</a><ul>
<li class="chapter" data-level="8.3.1" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#finding-out-whats-in-the-database"><i class="fa fa-check"></i><b>8.3.1</b> finding out what’s in the database</a></li>
<li class="chapter" data-level="8.3.2" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#sample-query"><i class="fa fa-check"></i><b>8.3.2</b> sample query</a></li>
<li class="chapter" data-level="8.3.3" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#subset-only-retrieve-what-you-need"><i class="fa fa-check"></i><b>8.3.3</b> Subset: only retrieve what you need</a></li>
<li class="chapter" data-level="8.3.4" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#make-the-server-do-as-much-work-as-you-can"><i class="fa fa-check"></i><b>8.3.4</b> Make the server do as much work as you can</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#what-is-dplyr-sending-to-the-server"><i class="fa fa-check"></i><b>8.4</b> What is dplyr sending to the server?</a></li>
<li class="chapter" data-level="8.5" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#writing-your-on-sql-directly-to-the-dbms"><i class="fa fa-check"></i><b>8.5</b> Writing your on SQL directly to the DBMS</a></li>
<li class="chapter" data-level="8.6" data-path="real-work-with-real-data-11.html"><a href="real-work-with-real-data-11.html#chosing-between-dplyr-and-native-sql"><i class="fa fa-check"></i><b>8.6</b> Chosing between dplyr and native SQL</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="real-work-with-real-data-12.html"><a href="real-work-with-real-data-12.html"><i class="fa fa-check"></i><b>9</b> Real work with real data (12)</a><ul>
<li class="chapter" data-level="9.1" data-path="real-work-with-real-data-12.html"><a href="real-work-with-real-data-12.html#some-extra-handy-libraries-1"><i class="fa fa-check"></i><b>9.1</b> Some extra handy libraries</a></li>
<li class="chapter" data-level="9.2" data-path="real-work-with-real-data-12.html"><a href="real-work-with-real-data-12.html#more-topics"><i class="fa fa-check"></i><b>9.2</b> More topics</a></li>
<li class="chapter" data-level="9.3" data-path="real-work-with-real-data-12.html"><a href="real-work-with-real-data-12.html#standards-for-production-jobs"><i class="fa fa-check"></i><b>9.3</b> Standards for production jobs</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="postgres-examples-part-a-13.html"><a href="postgres-examples-part-a-13.html"><i class="fa fa-check"></i><b>10</b> Postgres Examples, part A (13)</a><ul>
<li class="chapter" data-level="10.1" data-path="postgres-examples-part-a-13.html"><a href="postgres-examples-part-a-13.html#verify-docker-is-up-and-running"><i class="fa fa-check"></i><b>10.1</b> Verify Docker is up and running:</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="postgres-examples-part-b-14.html"><a href="postgres-examples-part-b-14.html"><i class="fa fa-check"></i><b>11</b> Postgres Examples, part B (14)</a><ul>
<li class="chapter" data-level="11.1" data-path="postgres-examples-part-b-14.html"><a href="postgres-examples-part-b-14.html#verify-docker-is-up-and-running-1"><i class="fa fa-check"></i><b>11.1</b> Verify Docker is up and running:</a></li>
<li class="chapter" data-level="11.2" data-path="postgres-examples-part-b-14.html"><a href="postgres-examples-part-b-14.html#sql-execution-steps"><i class="fa fa-check"></i><b>11.2</b> SQL Execution Steps</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="other-resources.html"><a href="other-resources.html"><i class="fa fa-check"></i><b>12</b> Other resources</a><ul>
<li class="chapter" data-level="12.1" data-path="other-resources.html"><a href="other-resources.html#editing-this-book"><i class="fa fa-check"></i><b>12.1</b> Editing this book</a></li>
<li class="chapter" data-level="12.2" data-path="other-resources.html"><a href="other-resources.html#docker-alternatives"><i class="fa fa-check"></i><b>12.2</b> Docker alternatives</a></li>
<li class="chapter" data-level="12.3" data-path="other-resources.html"><a href="other-resources.html#docker-and-r"><i class="fa fa-check"></i><b>12.3</b> Docker and R</a></li>
<li class="chapter" data-level="12.4" data-path="other-resources.html"><a href="other-resources.html#documentation-docker-and-postgres"><i class="fa fa-check"></i><b>12.4</b> Documentation Docker and Postgres</a></li>
<li class="chapter" data-level="12.5" data-path="other-resources.html"><a href="other-resources.html#more-resources"><i class="fa fa-check"></i><b>12.5</b> More Resources</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="13" data-path="mapping-your-local-environment-92.html"><a href="mapping-your-local-environment-92.html"><i class="fa fa-check"></i><b>13</b> Mapping your local environment (92)</a><ul>
<li class="chapter" data-level="13.1" data-path="mapping-your-local-environment-92.html"><a href="mapping-your-local-environment-92.html#environment-tools-used-in-this-chapter"><i class="fa fa-check"></i><b>13.1</b> Environment Tools Used in this Chapter</a></li>
<li class="chapter" data-level="13.2" data-path="mapping-your-local-environment-92.html"><a href="mapping-your-local-environment-92.html#communicating-with-docker-applications"><i class="fa fa-check"></i><b>13.2</b> Communicating with Docker Applications</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R, Databases and Docker</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-persistent-database-in-postgres-in-docker---all-at-once-05" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> A persistent database in Postgres in Docker - all at once (05)</h1>
<div id="overview" class="section level2">
<h2><span class="header-section-number">5.1</span> Overview</h2>
<p>You’ve already connected to PostgreSQL with R, now you need a “realistic” (<code>dvdrental</code>) database. We’re going to demonstrate how to set one up, with two different approaches. This chapter and the next do the same job, illustrating the different approaches that you can take and helping you see the different points where you could swap what’s provided here with a different DBMS or a different backup file or something else.</p>
<p>The code in this first version is recommended because it is an “all in one” approach. Details about how it works and how you might modify it are included below. There is another version in the the next chapter that you can use to investigate Docker commands and components.</p>
<p>Note that this approach relies on two files that have quote that’s not shown here: <a href="./dvdrental.Dockerfile">dvdrental.Dockerfile</a> and <a href="init-dvdrental.sh" class="uri">init-dvdrental.sh</a>. They are discussed below.</p>
<p>Note that <code>tidyverse</code>, <code>DBI</code>, <code>RPostgres</code>, and <code>glue</code> are loaded.</p>
</div>
<div id="first-verify-that-docker-is-up-and-running" class="section level2">
<h2><span class="header-section-number">5.2</span> First, verify that Docker is up and running:</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">system2</span>(<span class="st">&quot;docker&quot;</span>, <span class="st">&quot;version&quot;</span>, <span class="dt">stdout =</span> <span class="ot">TRUE</span>, <span class="dt">stderr =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;Client:&quot;                                        
##  [2] &quot; Version:           18.06.1-ce&quot;                 
##  [3] &quot; API version:       1.38&quot;                       
##  [4] &quot; Go version:        go1.10.3&quot;                   
##  [5] &quot; Git commit:        e68fc7a&quot;                    
##  [6] &quot; Built:             Tue Aug 21 17:21:31 2018&quot;   
##  [7] &quot; OS/Arch:           darwin/amd64&quot;               
##  [8] &quot; Experimental:      false&quot;                      
##  [9] &quot;&quot;                                               
## [10] &quot;Server:&quot;                                        
## [11] &quot; Engine:&quot;                                       
## [12] &quot;  Version:          18.06.1-ce&quot;                 
## [13] &quot;  API version:      1.38 (minimum version 1.12)&quot;
## [14] &quot;  Go version:       go1.10.3&quot;                   
## [15] &quot;  Git commit:       e68fc7a&quot;                    
## [16] &quot;  Built:            Tue Aug 21 17:29:02 2018&quot;   
## [17] &quot;  OS/Arch:          linux/amd64&quot;                
## [18] &quot;  Experimental:     true&quot;</code></pre>
</div>
<div id="clean-up-if-appropriate-1" class="section level2">
<h2><span class="header-section-number">5.3</span> Clean up if appropriate</h2>
<p>Remove the <code>sql-pet</code> container if it exists (e.g., from a prior run)</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="cf">if</span> (<span class="kw">system2</span>(<span class="st">&quot;docker&quot;</span>, <span class="st">&quot;ps -a&quot;</span>, <span class="dt">stdout =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="st">   </span><span class="kw">grepl</span>(<span class="dt">x =</span> ., <span class="dt">pattern =</span> <span class="st">&#39;sql-pet&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="st">   </span><span class="kw">any</span>()) {</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">     <span class="kw">system2</span>(<span class="st">&quot;docker&quot;</span>, <span class="st">&quot;rm -f sql-pet&quot;</span>)</a>
<a class="sourceLine" id="cb31-5" data-line-number="5">}</a></code></pre></div>
</div>
<div id="build-the-docker-image" class="section level2">
<h2><span class="header-section-number">5.4</span> Build the Docker Image</h2>
<p>Build an image that derives from postgres:10, defined in <code>dvdrental.Dockerfile</code>, that is set up to restore and load the dvdrental db on startup. The <a href="./dvdrental.Dockerfile">dvdrental.Dockerfile</a> is discussed below.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">system2</span>(<span class="st">&quot;docker&quot;</span>, </a>
<a class="sourceLine" id="cb32-2" data-line-number="2">        <span class="kw">glue</span>(<span class="st">&quot;build &quot;</span>, <span class="co"># tells Docker to build an image that can be loaded as a container</span></a>
<a class="sourceLine" id="cb32-3" data-line-number="3">          <span class="st">&quot;--tag postgres-dvdrental &quot;</span>, <span class="co"># (or -t) tells Docker to name the image</span></a>
<a class="sourceLine" id="cb32-4" data-line-number="4">          <span class="st">&quot;--file dvdrental.Dockerfile &quot;</span>, <span class="co">#(or -f) tells Docker to read `build` instructions from the dvdrental.Dockerfile</span></a>
<a class="sourceLine" id="cb32-5" data-line-number="5">          <span class="st">&quot; . &quot;</span>),  <span class="co"># tells Docker to look for dvdrental.Dockerfile in the current directory</span></a>
<a class="sourceLine" id="cb32-6" data-line-number="6">          <span class="dt">stdout =</span> <span class="ot">TRUE</span>, <span class="dt">stderr =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##  [1] &quot;Sending build context to Docker daemon  3.081MB\r\r&quot;                                                                                                                                                                                                                                                                                                                                           
##  [2] &quot;Step 1/4 : FROM postgres:10&quot;                                                                                                                                                                                                                                                                                                                                                                   
##  [3] &quot; ---&gt; ac25c2bac3c4&quot;                                                                                                                                                                                                                                                                                                                                                                            
##  [4] &quot;Step 2/4 : WORKDIR /tmp&quot;                                                                                                                                                                                                                                                                                                                                                                       
##  [5] &quot; ---&gt; Using cache&quot;                                                                                                                                                                                                                                                                                                                                                                             
##  [6] &quot; ---&gt; 3f00a18e0bdf&quot;                                                                                                                                                                                                                                                                                                                                                                            
##  [7] &quot;Step 3/4 : COPY init-dvdrental.sh /docker-entrypoint-initdb.d/&quot;                                                                                                                                                                                                                                                                                                                                
##  [8] &quot; ---&gt; Using cache&quot;                                                                                                                                                                                                                                                                                                                                                                             
##  [9] &quot; ---&gt; 3453d61d8e3e&quot;                                                                                                                                                                                                                                                                                                                                                                            
## [10] &quot;Step 4/4 : RUN apt-get -qq update &amp;&amp;   apt-get install -y -qq curl zip  &gt; /dev/null 2&gt;&amp;1 &amp;&amp;   curl -Os http://www.postgresqltutorial.com/wp-content/uploads/2017/10/dvdrental.zip &amp;&amp;   unzip dvdrental.zip &amp;&amp;   rm dvdrental.zip &amp;&amp;   chmod ugo+w dvdrental.tar &amp;&amp;   chown postgres dvdrental.tar &amp;&amp;   chmod u+x /docker-entrypoint-initdb.d/init-dvdrental.sh &amp;&amp;   apt-get remove -y curl zip&quot;
## [11] &quot; ---&gt; Using cache&quot;                                                                                                                                                                                                                                                                                                                                                                             
## [12] &quot; ---&gt; f5e93aa64875&quot;                                                                                                                                                                                                                                                                                                                                                                            
## [13] &quot;Successfully built f5e93aa64875&quot;                                                                                                                                                                                                                                                                                                                                                               
## [14] &quot;Successfully tagged postgres-dvdrental:latest&quot;</code></pre>
</div>
<div id="run-the-docker-image" class="section level2">
<h2><span class="header-section-number">5.5</span> Run the Docker Image</h2>
<p>Run docker to bring up postgres. The first time it runs it will take a minute to create the PostgreSQL environment. There are two important parts to this that may not be obvious:</p>
<ul>
<li>The <code>source=</code> parameter points to <a href="./dvdrental.Dockerfile">dvdrental.Dockerfile</a>, which does most of the heavy lifting. It has detailed, line-by-line comments to explain what it is doing.<br />
</li>
<li><em>Inside</em> <a href="./dvdrental.Dockerfile">dvdrental.Dockerfile</a> the command <code>COPY init-dvdrental.sh /docker-entrypoint-initdb.d/</code> copies <a href="init-dvdrental.sh" class="uri">init-dvdrental.sh</a> from the local file system into the specified location in the Docker container. When the PostgreSQL Docker container initializes, it looks for that file and executes it.</li>
</ul>
<p>Doing all of that work behind the scenes involves two layers of complexity. Depending on how you look at it, that may be more or less difficult to understand than the method shown in the next Chapter.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">wd &lt;-<span class="st"> </span><span class="kw">getwd</span>()</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"></a>
<a class="sourceLine" id="cb34-3" data-line-number="3">docker_cmd &lt;-<span class="st"> </span><span class="kw">glue</span>(</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">  <span class="st">&quot;run &quot;</span>,      <span class="co"># Run is the Docker command.  Everything that follows are `run` parameters.</span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5">  <span class="st">&quot;--detach &quot;</span>, <span class="co"># (or `-d`) tells Docker to disconnect from the terminal / program issuing the command</span></a>
<a class="sourceLine" id="cb34-6" data-line-number="6">  <span class="st">&quot; --name sql-pet &quot;</span>,     <span class="co"># tells Docker to give the container a name: `sql-pet`</span></a>
<a class="sourceLine" id="cb34-7" data-line-number="7">  <span class="st">&quot;--publish 5432:5432 &quot;</span>, <span class="co"># tells Docker to expose the Postgres port 5432 to the local network with 5432</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8">  <span class="st">&quot;--mount &quot;</span>, <span class="co"># tells Docker to mount a volume -- mapping Docker&#39;s internal file structure to the host file structure</span></a>
<a class="sourceLine" id="cb34-9" data-line-number="9">  <span class="st">&quot;type=bind,&quot;</span>, <span class="co"># tells Docker that the mount command points to an actual file on the host system</span></a>
<a class="sourceLine" id="cb34-10" data-line-number="10">  <span class="st">&#39;source=&quot;&#39;</span>, <span class="co"># tells Docker where the local file will be found</span></a>
<a class="sourceLine" id="cb34-11" data-line-number="11">  wd, <span class="st">&#39;/&quot;,&#39;</span>, <span class="co"># the current working directory, as retrieved above</span></a>
<a class="sourceLine" id="cb34-12" data-line-number="12">  <span class="st">&quot;target=/petdir&quot;</span>, <span class="co"># tells Docker to refer to the current directory as &quot;/petdir&quot; in its file system</span></a>
<a class="sourceLine" id="cb34-13" data-line-number="13">  <span class="st">&quot; postgres-dvdrental&quot;</span> <span class="co"># tells Docker to run the image was built in the previous step</span></a>
<a class="sourceLine" id="cb34-14" data-line-number="14">)</a>
<a class="sourceLine" id="cb34-15" data-line-number="15"></a>
<a class="sourceLine" id="cb34-16" data-line-number="16"><span class="co"># if you are curious you can paste this string into a terminal window after the command &#39;docker&#39;:</span></a>
<a class="sourceLine" id="cb34-17" data-line-number="17">docker_cmd</a></code></pre></div>
<pre><code>## run --detach  --name sql-pet --publish 5432:5432 --mount type=bind,source=&quot;/Users/jds/Documents/Library/R/r-system/sql-pet/r-database-docker/&quot;,target=/petdir postgres-dvdrental</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw">system2</span>(<span class="st">&quot;docker&quot;</span>, docker_cmd, <span class="dt">stdout =</span> <span class="ot">TRUE</span>, <span class="dt">stderr =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] &quot;fc61dd4507af01fc53ea38c2a7cd96ae8b1f50564a5f2cf2c54f44d15fdfe9fc&quot;</code></pre>
</div>
<div id="connect-to-postgres-with-r" class="section level2">
<h2><span class="header-section-number">5.6</span> Connect to Postgres with R</h2>
<p>Use the DBI package to connect to PostgreSQL. But first, wait for Docker &amp; PostgreSQL to come up before connecting.</p>
<p>We have loaded the <code>wait_for_postgres</code> function behind the scenes.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1">con &lt;-<span class="st"> </span><span class="kw">wait_for_postgres</span>(<span class="dt">user =</span> <span class="kw">Sys.getenv</span>(<span class="st">&quot;DEFAULT_POSTGRES_USER_NAME&quot;</span>),</a>
<a class="sourceLine" id="cb38-2" data-line-number="2">                         <span class="dt">password =</span> <span class="kw">Sys.getenv</span>(<span class="st">&quot;DEFAULT_POSTGRES_PASSWORD&quot;</span>),</a>
<a class="sourceLine" id="cb38-3" data-line-number="3">                         <span class="dt">dbname =</span> <span class="st">&quot;dvdrental&quot;</span>,</a>
<a class="sourceLine" id="cb38-4" data-line-number="4">                         <span class="dt">seconds_to_test =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb38-5" data-line-number="5"></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="co"># if (con == &quot;it&#39;s not there&quot;) {stop()}</span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="kw">dbListTables</span>(con)</a></code></pre></div>
<pre><code>##  [1] &quot;actor_info&quot;                 &quot;customer_list&quot;             
##  [3] &quot;film_list&quot;                  &quot;nicer_but_slower_film_list&quot;
##  [5] &quot;sales_by_film_category&quot;     &quot;staff&quot;                     
##  [7] &quot;sales_by_store&quot;             &quot;staff_list&quot;                
##  [9] &quot;category&quot;                   &quot;film_category&quot;             
## [11] &quot;country&quot;                    &quot;actor&quot;                     
## [13] &quot;language&quot;                   &quot;inventory&quot;                 
## [15] &quot;payment&quot;                    &quot;rental&quot;                    
## [17] &quot;city&quot;                       &quot;store&quot;                     
## [19] &quot;film&quot;                       &quot;address&quot;                   
## [21] &quot;film_actor&quot;                 &quot;customer&quot;</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">dbListFields</span>(con, <span class="st">&quot;rental&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;rental_id&quot;    &quot;rental_date&quot;  &quot;inventory_id&quot; &quot;customer_id&quot; 
## [5] &quot;return_date&quot;  &quot;staff_id&quot;     &quot;last_update&quot;</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">dbDisconnect</span>(con)</a>
<a class="sourceLine" id="cb42-2" data-line-number="2"></a>
<a class="sourceLine" id="cb42-3" data-line-number="3"><span class="kw">Sys.sleep</span>(<span class="dv">2</span>) <span class="co"># Can take a moment to disconnect.</span></a></code></pre></div>
</div>
<div id="stop-and-start-to-demonstrate-persistence" class="section level2">
<h2><span class="header-section-number">5.7</span> Stop and start to demonstrate persistence</h2>
<p>Stop the container</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw">system2</span>(<span class="st">&#39;docker&#39;</span>, <span class="st">&#39;stop sql-pet&#39;</span>,</a>
<a class="sourceLine" id="cb43-2" data-line-number="2">        <span class="dt">stdout =</span> <span class="ot">TRUE</span>, <span class="dt">stderr =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] &quot;sql-pet&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw">Sys.sleep</span>(<span class="dv">3</span>) <span class="co"># can take a moment for Docker to stop the container.</span></a></code></pre></div>
<p>Restart the container and verify that the dvdrental tables are still there</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">system2</span>(<span class="st">&quot;docker&quot;</span>,  <span class="st">&quot;start sql-pet&quot;</span>, <span class="dt">stdout =</span> <span class="ot">TRUE</span>, <span class="dt">stderr =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] &quot;sql-pet&quot;</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">con &lt;-<span class="st"> </span><span class="kw">wait_for_postgres</span>(<span class="dt">user =</span> <span class="kw">Sys.getenv</span>(<span class="st">&quot;DEFAULT_POSTGRES_USER_NAME&quot;</span>),</a>
<a class="sourceLine" id="cb48-2" data-line-number="2">                         <span class="dt">password =</span> <span class="kw">Sys.getenv</span>(<span class="st">&quot;DEFAULT_POSTGRES_PASSWORD&quot;</span>),</a>
<a class="sourceLine" id="cb48-3" data-line-number="3">                         <span class="dt">dbname =</span> <span class="st">&quot;dvdrental&quot;</span>,</a>
<a class="sourceLine" id="cb48-4" data-line-number="4">                         <span class="dt">seconds_to_test =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb48-5" data-line-number="5"></a>
<a class="sourceLine" id="cb48-6" data-line-number="6"><span class="kw">glimpse</span>(<span class="kw">dbReadTable</span>(con, <span class="st">&quot;film&quot;</span>))</a></code></pre></div>
<pre><code>## Observations: 1,000
## Variables: 13
## $ film_id          &lt;int&gt; 133, 384, 8, 98, 1, 2, 3, 4, 5, 6, 7, 9, 10, ...
## $ title            &lt;chr&gt; &quot;Chamber Italian&quot;, &quot;Grosse Wonderful&quot;, &quot;Airpo...
## $ description      &lt;chr&gt; &quot;A Fateful Reflection of a Moose And a Husban...
## $ release_year     &lt;int&gt; 2006, 2006, 2006, 2006, 2006, 2006, 2006, 200...
## $ language_id      &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, ...
## $ rental_duration  &lt;int&gt; 7, 5, 6, 4, 6, 3, 7, 5, 6, 3, 6, 3, 6, 6, 6, ...
## $ rental_rate      &lt;dbl&gt; 4.99, 4.99, 4.99, 4.99, 0.99, 4.99, 2.99, 2.9...
## $ length           &lt;int&gt; 117, 49, 54, 73, 86, 48, 50, 117, 130, 169, 6...
## $ replacement_cost &lt;dbl&gt; 14.99, 19.99, 15.99, 12.99, 20.99, 12.99, 18....
## $ rating           &lt;chr&gt; &quot;NC-17&quot;, &quot;R&quot;, &quot;R&quot;, &quot;PG-13&quot;, &quot;PG&quot;, &quot;G&quot;, &quot;NC-17...
## $ last_update      &lt;dttm&gt; 2013-05-26 14:50:58, 2013-05-26 14:50:58, 20...
## $ special_features &lt;chr&gt; &quot;{Trailers}&quot;, &quot;{\&quot;Behind the Scenes\&quot;}&quot;, &quot;{Tr...
## $ fulltext         &lt;chr&gt; &quot;&#39;chamber&#39;:1 &#39;fate&#39;:4 &#39;husband&#39;:11 &#39;italian&#39;:...</code></pre>
<p>It’s always good to have R disconnect from the database</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">dbDisconnect</span>(con)</a></code></pre></div>
<p>Stop the container &amp; show that the container is still there, so can be started again.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw">system2</span>(<span class="st">&#39;docker&#39;</span>, <span class="st">&#39;stop sql-pet&#39;</span>,</a>
<a class="sourceLine" id="cb51-2" data-line-number="2">        <span class="dt">stdout =</span> <span class="ot">TRUE</span>, <span class="dt">stderr =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## [1] &quot;sql-pet&quot;</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" data-line-number="1"><span class="co"># show that the container still exists even though it&#39;s not running</span></a>
<a class="sourceLine" id="cb53-2" data-line-number="2">psout &lt;-<span class="st"> </span><span class="kw">system2</span>(<span class="st">&quot;docker&quot;</span>, <span class="st">&quot;ps -a&quot;</span>, <span class="dt">stdout =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb53-3" data-line-number="3">psout[<span class="kw">grepl</span>(<span class="dt">x =</span> psout, <span class="dt">pattern =</span> <span class="st">&#39;sql-pet&#39;</span>)]</a></code></pre></div>
<pre><code>## [1] &quot;fc61dd4507af        postgres-dvdrental   \&quot;docker-entrypoint.s…\&quot;   22 seconds ago      Exited (0) Less than a second ago                       sql-pet&quot;</code></pre>
</div>
<div id="cleaning-up" class="section level2">
<h2><span class="header-section-number">5.8</span> Cleaning up</h2>
<p>Next time, you can just use this command to start the container:</p>
<p><code>system2(&quot;docker&quot;,  &quot;start sql-pet&quot;, stdout = TRUE, stderr = TRUE)</code></p>
<p>And once stopped, the container can be removed with:</p>
<p><code>system2(&quot;docker&quot;,  &quot;rm sql-pet&quot;, stdout = TRUE, stderr = TRUE)</code></p>
</div>
<div id="using-the-sql-pet-container-in-the-rest-of-the-book" class="section level2">
<h2><span class="header-section-number">5.9</span> Using the <code>sql-pet</code> container in the rest of the book</h2>
<p>After this point in the book, we assume that Docker is up and that we can always start up our <em>sql-pet database</em> with:</p>
<p><code>system2(&quot;docker&quot;,  &quot;start sql-pet&quot;, stdout = TRUE, stderr = TRUE)</code></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="docker-postgres-and-r-04.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-persistent-database-in-postgres-in-docker-piecemeal-06.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smithjd/sql-pet/edit/master/r-database-docker/05-docker-setup-postgres-with-dvdrental.Rmd",
"text": "Edit"
},
"download": ["r-database-docker.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
